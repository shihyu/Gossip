<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/JavaEssence/EqualOperator.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:13:25 GMT -->
<head>


  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">

  <link rel="stylesheet" href="css/print.css" type="text/css">

  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>我們沒什麼不同</title></head><body>

<h3><a href="../index.html">From
Gossip@Openhome</a></h3>

<h1><a href="index-2.html">Java Essence: 我們沒什麼不同</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="width: 250px; text-align: center; vertical-align: top;"><script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js"></script><br>

      <br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js"></script><br>

      <br>

      <center>
       <br>

      </center>

      </td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>學Java時，對於=的解釋，總會說：<span style="font-weight: bold;">「用於基本型態時，=是將值複製給變數，用於物件時，=是將物件給參考名稱來參考」</span>。對於==的解釋，總是會這麼說：<span style="font-weight: bold;">「作用於基本型態時，==用於比較兩個變數儲存的值是否相同，作用於參考名稱時，是用於比較兩個名稱是否參考至同一物件！」</span>這種說法沒有錯，但就有人認為，=與==被重載了，作用於基本型態變數與參考名稱時，會有不同的處理方式。真是如此嗎？<br><br>當你宣告一個基本型態變數並指定值時，例如：<br></small><div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">int x = 1;</span></small><br></div><small><br>JVM會在記憶體的stack區開設一塊空間，儲存1這個值：<br><img style="width: 121px; height: 198px;" alt="" src="images/EqualOperator-1.jpg"><br><br>當你宣告一個參考名稱，並建立一個物件指定給該名稱時，例如：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Object o = new Object();</span></small><br></div><small><br>使用new時，JVM會在heap區取得一個空間來建立物件，你將物件指定給參考名稱，表示你將物件的記憶體位址設定給參考名稱，也就是JVM會在stack開設一塊空間，儲存這個記憶體位址：<br><img style="width: 378px; height: 199px;" alt="" src="images/EqualOperator-2.jpg"><br><br>如果你這麼撰寫程式：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace; font-weight: bold;">int x = 10;</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;"><small style="font-family: Courier New,Courier,monospace; font-weight: bold;">int y = x;</small><br></div><small><br>則是將x變數的值儲存值複製設定給y：<br><img style="width: 117px; height: 197px;" alt="" src="images/EqualOperator-3.jpg"><br><br>而使用==比較時，正是比較變數所儲存的值是否相同，所以x==y會是true。那如果你這麼撰寫程式：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Object o1 = new Object();</span></small><br><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Object o2 = o1;</span></small><br></div><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"><br></span></small><small>實際上你是將o1儲存的值複製設定給o2，也就是：<br><img style="width: 388px; height: 210px;" alt="" src="images/EqualOperator-4.jpg"><br></small><small>而使用==比較時，正是比較變數所儲存的值是否相同，所以o1==o2會是true。那如果你這麼撰寫程式：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Object o3 = new Object();</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br></div><small><br><img style="width: 386px; height: 257px;" alt="" src="images/EqualOperator-5.jpg"><br><br></small><small>而使用==比較時，正是比較變數所儲存的值是否相同，所以o1==o3會是false，o2==o3也會是false。<br><br>以上是底層行為的示意，</small><small>只不過Java中並不允許直接處理記憶體位址，為了解釋，稱這種行為叫作<span style="font-weight: bold;">「參考」（Reference）</span>，如果你沒有學過C++，這沒什麼問題，但如果你學過C++，可能會跟C++中的參考發生混淆，因為Java中的參考與C++中的參考指的並不是相同的東西，只是剛好都叫作「參考」而已。<br><br>因為</small><small>Java中並不允許直接處理記憶體位址，</small><small>一般為了表示這樣的程式片段：<br></small><div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Object o1 = new Object();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Object o2 = o1;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Object o3 = new Object();</span></small><br></div><small><br></small><small>會這麼畫：<br><img style="width: 230px; height: 165px;" alt="" src="images/EqualOperator-6.jpg"><br><br>再根據圖中o1、o2、o3是否綁在同一個物件上，跟你說明==於o1、o2、o3比較的結果。<br><br>我曾經聽過一個比較有趣的說法，雖然Java中建構式不用宣告傳回值，也不用宣告void，但實際上，建構式是有傳回值的，傳回值就是物件在記憶體中的位址，只不過你不能處理這個位址資訊罷了。這樣的說法，用來閱讀這篇文件中所在說明的行為，也不失為一種理解的方式。<br><br></small></td>

    </tr>

  </tbody>
</table>

<br>

<br>

<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script>
</body>
<!-- Mirrored from openhome.cc/Gossip/JavaEssence/EqualOperator.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:13:29 GMT -->
</html>