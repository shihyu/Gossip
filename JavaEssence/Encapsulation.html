<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/JavaEssence/Encapsulation.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:13:55 GMT -->
<head>

  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">

  <link rel="stylesheet" href="css/print.css" type="text/css">

  <meta content="text/html; charset=Big5" http-equiv="content-type">
  <title>封不封裝有差嗎？</title></head>
<body>

<h3><a href="../index.html">From
Gossip@Openhome</a></h3>

<h1><a href="index-2.html">Java Essence: 封不封裝有差嗎？</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="width: 250px; text-align: center; vertical-align: top;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js"></script><br>

      <br>
<script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js"></script><br>

      <br>

      </td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>你可以設計一個帳戶類別來持有一個銀行帳戶所需的資訊：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Account {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; String name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; String id;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; double balance;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>這只是單純將類別作為多個資料的集中地。如果要提款，你也許會這麼撰寫程式：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Account account = new Account();<br>...<br>account.balance =</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> account.</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">balance - money;</span></small><br></div><small><br>如果money是來自於使用者的輸入，你也許應該防範一下被輸入負數：<br style="font-weight: bold; font-family: Courier New,Courier,monospace;"></small><div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">if(money &gt; 0) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; </span>account.balance =</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"> account.</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">balance - money;</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">} else {<br>&nbsp; &nbsp; throw new RuntimeException("不得為負數");<br>}</span></small></div><small><br>如果Account類別只是你一個人用，你也許會記得要作檢查，但如果別人打算使用Account類別，就不見得會記得這件事。為此，你也許會這麼寫：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Account {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; String name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; String id;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; double balance;<br><br></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; public void withdraw(double money) {</span></small><br><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; &nbsp; &nbsp; </span></small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">if(money &gt; 0) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>account.balance =</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"> account.</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">balance - money;</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new RuntimeException("不得為負數");<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>這麼一來，使用Account的其他人，就只要呼叫withdraw()方法，就可以進行提款動作，也可獲得檢查是否為負數的行為：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Account account = new Account();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">...</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">account.withdraw(100);</span></small><br></div><small><br>不過事實上，使用Account的人若打算這麼作，目前你的Account是沒什麼方法阻止的：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Account account = new Account();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">...</span></small><br><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">double money = -10000;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span>account.balance =</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"> account.</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">balance - money;</small><br></div><small><br>你設計的檢查機制沒派上用場，因為他可以直接存取Account物件的balance（如果存心要惡搞的話）。你應該讓他沒辦法直接存取Account的資料成員：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Account {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; private String name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; private String id;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; private double balance;</span></small><br><small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; public void setName(String name) { this.name = name; }</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; public void setId(String id) { this.id = id; }</span></small><br><br><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; public void withdraw(double money) {</span></small><br><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; &nbsp; &nbsp; </span></small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">if(money &lt; 0) {<br></span></small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new RuntimeException("不得為負數");<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>balance =</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">balance - money;</small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><br><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>由於類別的資料成員用了private宣告，它們會是Account的私用成員，對使用Account的人來說，他看不到也存取不到private成員，就算知道內部private成員的名稱，撰寫了先前的程式碼：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">double money = -10000;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span>account.balance =</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"> account.</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">balance - money;</small><br></div><small><br>編譯器也不會讓這樣的程式碼通過編譯，這麼一來，使用Account的，就只能透過你所提供的公開方法來操作，或修改Account的內部狀態。<br><br>假設你的Account已經有人使用了，現在你發現，withdraw()應該再檢查一下餘額是否足夠，不然會被提款成為負餘額，所以你作了修改：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Account {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; private String name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; private String id;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; private double balance;</span></small><br><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; public void setName(String name) { this.name = name; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; public void setId(String id) { this.id = id; }</span></small><br><br><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; public void withdraw(double money) {</span></small><br><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; &nbsp; &nbsp; </span></small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">if(money &lt; 0) {<br></span></small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new RuntimeException("不得為負數");<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span></small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">balance - money &lt; 0</small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">) {<br></span></small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new RuntimeException("額餘不足");</span></small><br><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; &nbsp; &nbsp; }<br style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>balance =</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;</small><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">balance - money;</small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><br><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>你重新編譯這個類別之後，使用這個類別的客戶端並不用作任何修改，因為他們只使用公開的操作介面，對實際上withdraw()的內部實作一無所悉。<br><br>這是個封裝的簡單例子。<span style="font-weight: bold;">「封裝」一如其名稱所示，將一些資訊封存包裝在物件之中，這些所謂被封裝的資訊包括了物件的內部狀態、行為的實作細節。由於封裝，你就只需要在意如何操作物件，以及物件之間如何互動。</span><br style="font-weight: bold;"><br style="font-weight: bold;"><span style="font-weight: bold;">就語法上而言，封裝是在定義類別時，將資料成員設定為private，使之無法被外界存取，資料成員既然設定為private，若需提供給外界存取時，則必須提供公開操作介面，具體來說也就是公開方法，這讓你有機會在方法實作時進行相關流程，確認對資料成員的存取方式。</span><br><br><br><br></small></td>

    </tr>

  </tbody>
</table>

<br>

<br>

<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script>
</body>
<!-- Mirrored from openhome.cc/Gossip/JavaEssence/Encapsulation.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:13:55 GMT -->
</html>