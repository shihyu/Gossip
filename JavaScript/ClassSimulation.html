<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/JavaScript/ClassSimulation.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:22 GMT -->
<head>



















  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>類別模擬</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">JavaScript Essence: 類別模擬<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><center><script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center></td>

      <td style="vertical-align: top; width: 690px; text-align: left;">
      <div style="text-align: right;"><a href="http://openhome.cc/eGossip/JavaScript/ClassSimulations.html"><span style="font-weight: bold;">English</span></a><br>
      </div>
      <small><br>
類別的模擬主要就是先前觀念的綜合應用，以類別定義與繼承來說，基本上可以如下：</small><br>
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">function Circle(x, y, r) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; // 設定物件各自狀態</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; this.x = x;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; this.y = y;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; this.r = r;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Circle.PI = 3.14159; // 相當於Java類別的靜態方法</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">// 共用的物件方法設定在 prototype 上</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Circle.prototype.area = function() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; return this.r * this.r * Circle.PI;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">};</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Circle.prototype.toString = function() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; var text = [];</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; for(var p in this) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(typeof this[p] != 'function') {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; text.push(p + ':' + this[p]);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; return '[' + text.join() + ']';</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">};</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">function Cylinder(x, y, r, h) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; Circle.call(this, x, y, r); // 呼叫父建構式</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; this.h = h;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">// 原型繼承</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Cylinder.prototype = new Circle();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">// 設定原型物件之constructor為目前建構式</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Cylinder.prototype.constructor = Cylinder;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">// 以下在new時會再建構，不需要留在原型物件上</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">delete Cylinder.prototype.x;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">delete Cylinder.prototype.y;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">delete Cylinder.prototype.r;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">// 共用的物件方法設定在 prototype 上</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Cylinder.prototype.volumn = function() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; return this.area() * this.h;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">};</span></small><br>
      </div>
      <br>
      <small>如果你想讓外觀上看起來更像是Java之類的類別定義。可以將以上的流程封起來。例如，將建立類別的流程封裝起來：</small><br>
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">var Class = {};<br>
Class.create = function(methods) {<br>
&nbsp;&nbsp;&nbsp; var Clz = methods.initialize;<br>
&nbsp;&nbsp;&nbsp; for(var mth in methods) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(mth != 'initialize') {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Clz.prototype[mth] = methods[mth];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; return Clz;<br>
};</span><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small><br>
      </div>
      <br>
      <small>那麼你就可以這麼使用：</small><br>
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">var Circle = Class.create(<span style="color: red;">{</span></span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp; initialize : function(x, y, r) { // 作為建構式</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.x = x;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.y = y;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.r = r;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp; },</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp; area : function() {</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Math.PI * Math.pow(this.r, 2);</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp; },</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp; toString : function() {</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; var text = [];</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(var p in this) {</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(typeof this[p] != 'function') {</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; text.push(p + ':' + this[p]);</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; return '[' + text.join() + ']';</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp; }</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;"><span style="color: red;">}</span>);<br>
var circle = new Circle(10, 10, 5);<br>
</span></small>
      </div>






      <br>
      <small>如果想封裝類別的繼承，則可以這麼作：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Class.extend = function(Superclz, methods) {<br>
&nbsp;&nbsp;&nbsp; var Subclz = this.create(methods);<br>
&nbsp;&nbsp;&nbsp; var subproto = Subclz.prototype;<br>
&nbsp;&nbsp;&nbsp; Subclz.prototype = new Superclz();<br>
&nbsp;&nbsp;&nbsp; for(var p in Subclz.prototype) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(Subclz.prototype.hasOwnProperty(p)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete Subclz.prototype[p];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; Subclz.prototype.constructor = Subclz;<br>
&nbsp;&nbsp;&nbsp; for(var p in subproto) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Subclz.prototype[p] = subproto[p];<br>
&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; return Subclz;<br>
};</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br>
</div>
      <br>
      <small style="font-family: Courier New,Courier,monospace;">例如，想繼承先前建立的Circle，則可以如下：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">var Cylinder = Class.extend(<span style="color: red;">Circle</span>, <span style="color: red;">{</span></span></small><br style="font-weight: bold; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; initialize : function(x, y, r, h) {</span></small><br style="font-weight: bold; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Circle.call(this, x, y, r);</span></small><br style="font-weight: bold; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.h = h;</span></small><br style="font-weight: bold; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; },</span></small><br style="font-weight: bold; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; volumn : function() {</span></small><br style="font-weight: bold; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return this.area() * this.h;</span></small><br style="font-weight: bold; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; color: red;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"><span style="color: red;">}</span>);<br>
var cylinder = new Cylinder(10, 10, 5, 15);<br>
</span></small>
      </div>
      <small style="font-family: Courier New,Courier,monospace;"><br>
以上僅是類別</small><small style="font-family: Courier New,Courier,monospace;">模擬</small><small style="font-family: Courier New,Courier,monospace;">的概念，至於想要模擬到什麼程度，或者是想達到什麼樣的風格，其實有各種的設計方式。<br>
      </small><br>
<br>
</td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/JavaScript/ClassSimulation.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:22 GMT -->
</html>