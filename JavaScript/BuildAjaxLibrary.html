<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/JavaScript/BuildAjaxLibrary.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:45 GMT -->
<head>














  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>建立 Ajax 公用函式</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">JavaScript Essence: 建立 Ajax 公用函式<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><center> </center></td>

      <td style="vertical-align: top; width: 690px; text-align: left;">
      <div style="text-align: right;"><a href="http://openhome.cc/eGossip/JavaScript/AjaxLibrary.html">English</a><br>
      </div>
      <small><br>
照慣例，這邊基於</small> <small><a href="BuildStyleLibrary.html">封裝樣式處理</a> 的成果，繼續將先前的Ajax相關操作封裝起來，成果如下，有興趣的直接看程式碼研究看看：<br>
      </small>
      <ul>
        <li><a href="samples/js/gossip-0.5.js"><small>gossip-0.5.js</small></a></li>
      </ul>
      <br>
      <small>直接來看看使用這個程式庫，如何簡化 </small><small><a href="GET.html">使用 GET 請求</a> 中第二個範例：<br>
      </small>
      <ul>
        <li><a href="samples/BuildAjaxLibrary-1.html"><small>BuildAjaxLibrary-1.html</small></a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;<br>&lt;html&gt;<br>    &lt;head&gt;<br>        &lt;meta content="text/html; charset=Big5" http-equiv="content-type"&gt;<br>        &lt;script type="text/javascript" src="js/gossip-0.5.js"&gt;&lt;/script&gt;<br>        &lt;script type="text/javascript"&gt;<br>            XD.bind(window, 'load', function() {<br>                XD('#url').blur(function() {<br style="font-weight: bold;"><span style="font-weight: bold;">                    XD.get('GET-2.php', {url : XD(this).val()},</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        function(responseText) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                           var message = '';</span><br style="font-weight: bold;"><span style="font-weight: bold;">                           if(responseText === 'urlExisted') {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                               message = 'URL 已存在';</span><br style="font-weight: bold;"><span style="font-weight: bold;">                           }</span><br style="font-weight: bold;"><span style="font-weight: bold;">                           XD('#message').html(message);</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        }</span><br style="font-weight: bold;"><span style="font-weight: bold;">                   );</span><br>                });<br>            });<br>        &lt;/script&gt;        <br>    &lt;/head&gt;<br>    &lt;body&gt;<br>        新增書籤：&lt;br&gt;<br>        網址：&lt;input id="url" type="text"&gt;<br>        &lt;span id="message" style="color:red"&gt;&lt;/span&gt;&lt;br&gt;<br>        名稱：&lt;input type="text"&gt;<br>    &lt;/body&gt;<br>&lt;/html&gt;<br></pre>
      <small><br>
來看看如何簡化 </small><small><a href="XML.html">傳送與接收 XML</a> 中的範例：<br>
      </small>
      <ul>
        <li><a href="samples/BuildAjaxLibrary-2.html"><small>BuildAjaxLibrary-2.html</small></a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;<br>&lt;html&gt;<br>    &lt;head&gt;<br>        &lt;meta content="text/html; charset=Big5" http-equiv="content-type"&gt;<br>        &lt;script type="text/javascript" src="js/gossip-0.5.js"&gt;&lt;/script&gt;<br>        &lt;script type="text/javascript"&gt;<br>            XD.bind(window, 'load', function() {<br>                XD('#category').change(function() {<br style="font-weight: bold;"><span style="font-weight: bold;">                    XD.get('XML-1.php', {category : this.value}, </span><br style="font-weight: bold;"><span style="font-weight: bold;">                        function(responseXML) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            var select = XD('&lt;select&gt;')[0];</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            var options = </span><br style="font-weight: bold;"><span style="font-weight: bold;">                              responseXML.getElementsByTagName('option');</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            XD.each(options, function(option) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                var value = option.getAttribute('value');</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                var text = option.firstChild.nodeValue;</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                if(navigator.userAgent</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                            .indexOf('MSIE') === -1) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                    select.add(new Option(text, value), </span><br style="font-weight: bold;"><span style="font-weight: bold;">                                        select.options[</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                           select.options.length]);</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                }</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                else {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                    select.add(new Option(text, value),</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                        select.options.length);</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                }</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            });</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            XD('#book').removeChilds().append(select);</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        },</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    'xml')</span>;<br>                });<br>            });<br>        &lt;/script&gt;        <br>    &lt;/head&gt;<br>    &lt;body&gt;<br>        圖書：&lt;br&gt;<br>        &lt;select id="category"&gt;<br>            &lt;option&gt;-- 選擇分類 --&lt;/option&gt;<br>            &lt;option value="theory"&gt;理論基礎&lt;/option&gt;<br>            &lt;option value="language"&gt;程式語言&lt;/option&gt;<br>            &lt;option value="web"&gt;網頁技術&lt;/option&gt;<br>        &lt;/select&gt;&lt;br&gt;&lt;br&gt;<br>        採購：&lt;div id="book"&gt;&lt;/div&gt;<br>    &lt;/body&gt;<br>&lt;/html&gt;<br></pre>
      <small><br>
來看看如何簡化 </small><small><big><a href="JSON.html"><small>傳送與接收 JSON</small></a></big> 中的範例：<br>
      </small>
      <ul>
        <li><a href="samples/BuildAjaxLibrary-3.html"><small>BuildAjaxLibrary-3.html</small></a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;<br>&lt;html&gt;<br>    &lt;head&gt;<br>        &lt;meta content="text/html; charset=Big5" http-equiv="content-type"&gt;<br>        &lt;style type="text/css"&gt;<br>            div {<br>                color: #ffffff;<br>                background-color: #ff0000;<br>                border-width: 1px;<br>                border-color: black;<br>                border-style: solid;<br>                position: absolute;<br>            }        <br>        &lt;/style&gt;<br>        &lt;script type="text/javascript" src="js/gossip-0.5.js"&gt;&lt;/script&gt;<br>        &lt;script type="text/javascript"&gt;<br>            XD.bind(window, 'load', function() {<br>                var searchXD = XD('#search').keyup(function() {<br>                    XD('div').each(function(element) {<br>                       XD(element).remove();<br>                    });<br>                    <br>                    if(searchXD.val() === '') {<br>                        return;<br>                    }<br>                <br style="font-weight: bold;"><span style="font-weight: bold;">                    XD.get('JSON-1.php', </span><br style="font-weight: bold;"><span style="font-weight: bold;">                      {keyword : searchXD.val()}, function(keywords) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        if(keywords.length !== 0) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            var innerHTML = '';</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            XD.each(keywords, function(keyword) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            innerHTML += (keyword + '&lt;br&gt;');</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            });</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            var offset = searchXD.offset();</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            XD('&lt;div&gt;')</span><br style="font-weight: bold;"><span style="font-weight: bold;">                              .html(innerHTML)</span><br style="font-weight: bold;"><span style="font-weight: bold;">                              .css({</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                  left : offset.left + 'px',</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                  top  : offset.top + </span><br style="font-weight: bold;"><span style="font-weight: bold;">                                         offset.offsetHeight + 'px',</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                  width: offset.offsetWidth + 'px'</span><br style="font-weight: bold;"><span style="font-weight: bold;">                              })</span><br style="font-weight: bold;"><span style="font-weight: bold;">                              .appendTo(document.body);</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        }</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    }, 'json');</span><br>                });<br>            });<br>        &lt;/script&gt;        <br>    &lt;/head&gt;<br>    &lt;body&gt;<br>        &lt;hr&gt;<br>        搜尋：&lt;input id="search" type="text"&gt;<br>    &lt;/body&gt;<br>&lt;/html&gt;<br></pre>
      <small><br>
來看看如何簡化 </small><small><big><a href="JSONP.html"><small>使用 JSONP 跨站請求</small></a></big> 中的範例：<br>
      </small>
      <ul>
        <li><a href="samples/BuildAjaxLibrary-4.html"><small>BuildAjaxLibrary-4.html</small></a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;<br>&lt;html&gt;<br>    &lt;head&gt;<br>        &lt;meta content="text/html; charset=Big5" http-equiv="content-type"&gt;<br>        &lt;script type="text/javascript" src="js/gossip-0.5.js"&gt;&lt;/script&gt;<br>        &lt;script type="text/javascript"&gt;<br>            XD.bind(window, 'load', function() {<br>                XD('#search').click(function() {<br>                    <span style="font-weight: bold;">XD.jsonp({</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        url      : 'http://api.flickr.com/services/' + </span><br style="font-weight: bold;"><span style="font-weight: bold;">                                   'feeds/photos_public.gne',</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        data     : {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            tagmode : 'any',</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            format  : 'json',</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            tags    : XD('#tags').val()</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        },</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        callback : function(data) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            var imagesXD = XD('#images').removeChilds();</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            XD.each(data.items, function(item) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                XD('&lt;img&gt;').attr('src', item.media.m)</span><br style="font-weight: bold;"><span style="font-weight: bold;">                                           .appendTo(imagesXD);</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            });</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        }</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    }, 'jsoncallback');</span><br>                });<br>            });<br>        &lt;/script&gt;        <br>    &lt;/head&gt;<br>    &lt;body&gt;<br>    	&lt;input id="tags"&gt;&lt;br&gt;<br>		&lt;button id="search"&gt;搜尋&lt;/button&gt;<br>    	&lt;div id="images"&gt;&lt;/div&gt;<br>    &lt;/body&gt;<br>&lt;/html&gt;<br></pre>
      <small><br>
      <br>
      <br>
      </small><br>
</td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/JavaScript/BuildAjaxLibrary.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:46 GMT -->
</html>