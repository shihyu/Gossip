<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/JavaScript/TopLeft.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:38 GMT -->
<head>



















  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>存取元素位置</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">JavaScript Essence: 存取元素位置<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><center> </center></td>

      <td style="vertical-align: top; width: 690px; text-align: left;">
      <div style="text-align: right;"><a href="http://openhome.cc/eGossip/JavaScript/ElementPositions.html"><small>English</small></a><br>
      </div>
      <small><br>
CSS的<span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">position</span>屬性可以設定不同的值，代表元素的定位方式，如果沒有設定，大多數元素預設是<span style="font-weight: bold;">static</span>，元素依序繪製在文件的流動版面。你還可以設定的值有<span style="font-weight: bold;"></span></span></small><small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">relative</span>、</span></small><small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">absolute</span>、<span style="font-weight: bold;">fixed</span><span style="font-weight: bold;"></span>與<span style="font-weight: bold;">inherit</span>。<br>
      <br>
</span></small><small><span style="font-family: Courier New,Courier,monospace;">元素的top表示距原點的垂直距離，正值為往下，left表示距原點的水平距離，正值為往右。</span></small><small><span style="font-family: Courier New,Courier,monospace;">bottom表示距原點的垂直距離，正值為往上，right表示距原點的水平距離，正值為往左。<br>
      <br>
</span></small><small><span style="font-family: Courier New,Courier,monospace;">
absolute表示絕對定位，可以藉由設置元素<span style="font-weight: bold;">top</span>、<span style="font-weight: bold;">left</span>或<span style="font-weight: bold;">bottom</span>、<span style="font-weight: bold;">right</span>來定位，定位是相對於元素的首個非static定位的父元素。</span></small><small><span style="font-family: Courier New,Courier,monospace;">在絕對定位時，元素可以堆疊，此時可利用<span style="font-weight: bold;">z-index</span>來設定重壘順序，數值越大，表示可以堆壘在越上面，z-index預設是頁面中標籤定義的順序，越後定義的標籤z-index越大。<br>
      <br>
下面這個範例運用了絕對定位、top、left與z-index屬性，可以使用滑鼠點選改變id為message1的&lt;div&gt;的位置，可以按下某個&lt;div&gt;，使之z-index提高：<br>
</span></small>
      <ul>
        <li><a href="samples/TopLeft-1.html"><small>TopLeft-1.html</small></a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;<br>&lt;html&gt;<br>    &lt;head&gt;<br>        &lt;meta content="text/html; charset=Big5" http-equiv="content-type"&gt;<br>        &lt;style type="text/css"&gt;<br>            #message1 {<br>                color: #ffffff;<br>                background-color: #ff0000;<br>                border-width: 10px;<br>                border-color: black;<br>                border-style: solid;<br>                width: 100px;<br>                height: 50px;<br>                padding: 50px;<br>                margin: 10px;<br>                position: absolute;<br>                top: 50px;<br>                left: 50px;<br>                z-index: 0;                <br>            }<br>            #message2 {<br>                color: #ffffff;<br>                background-color: #ff0000;<br>                border-width: 10px;<br>                border-color: black;<br>                border-style: solid;<br>                width: 100px;<br>                height: 50px;<br>                padding: 50px;<br>                margin: 10px;<br>                position: absolute;<br>                top: 150px;<br>                left: 150px;<br>                z-index: 0;                <br>            }<br>        &lt;/style&gt;<br>        &lt;script type="text/javascript"&gt;<br>            window.onload = function(event) {<br>                var message1 = document.getElementById('message1');<br>                var message2 = document.getElementById('message2');<br>                <br>                document.onclick = function(event) {<br>                    event = event || window.event;<br>                    message1.style.left = event.clientX + 'px';<br>                    message1.style.top = event.clientY + 'px';<br>                };<br>                <br>                function stopPropagation(event) {<br>                    if(event) {<br>                        event.stopPropagation();<br>                    }<br>                    else {<br>                        window.event.cancelBubble = true;<br>                    }<br>                }<br>                <br>                message1.onclick = function(event) {<br>                    this.style.zIndex = 1;<br>                    message2.style.zIndex = 0;<br>                    stopPropagation(event);<br>                };<br>                <br>                message2.onclick = function(event) {<br>                    this.style.zIndex = 1;<br>                    message1.style.zIndex = 0;<br>                    stopPropagation(event);<br>                };<br>            };<br>        &lt;/script&gt;        <br>    &lt;/head&gt;<br>    &lt;body&gt;<br>        &lt;div id="message1"&gt;這是訊息一&lt;/div&gt;<br>        &lt;div id="message2"&gt;這是訊息二&lt;/div&gt;<br>    &lt;/body&gt;<br>&lt;/html&gt;<br></pre>
      <small><span style="font-family: Courier New,Courier,monospace;"><br>
      </span></small><small><span style="font-family: Courier New,Courier,monospace;">relative
則是表示元素將相對於標準位置擺放，相對值是使用top、left或bottom、right設定。例如，若某元素標準位置為100x50的位置，若設定
該元素的position為relative，而top、left分別設為20、30的話，則元素最後的位置就是在(100+20)x(50+30)=
120x80的位置。<br>
      <br>
fixed則是以瀏覽器視埠（</span>view-port<span style="font-family: Courier New,Courier,monospace;">）為基準點。例如，你想要讓某個元素在捲動後，依舊可以在可視畫面中的100x50的位置，則可以將position設為fixed，此時top、left與bottom、right就是相對於可視畫面。在</span>Internet Explorer<span style="font-family: Courier New,Courier,monospace;"> 6瀏覽器中不支援，</span></small>Internet Explorer 7/8<small><span style="font-family: Courier New,Courier,monospace;">只有在指定&lt;!DOCTYPE&gt;時才支援，<br>
      <br>要取得元素的確實位置，必須知道<span style="font-weight: bold;">offsetParent</span>為何，offsetParent並非元素的直接父節點，而是在元素的所有父階層中，第一個可用來作為位置參考的節點。<br>
      </span></small><small><span style="font-family: Courier New,Courier,monospace;"><br>
每個元素都可以取得<span style="font-weight: bold;">offsetTop</span>、<span style="font-weight: bold;">offsetLeft</span>，分別代表距offsetParent外邊框左上角的距離，所以，在簡單的排版下，想要知道元素在版面中的確實位置，基本上可以如下：<br>
      </span></small>
      <ul>
        <li><small><a href="samples/TopLeft-2.html">TopLeft-2.html</a><span style="font-family: Courier New,Courier,monospace;"></span></small></li>
      </ul>
      <small><span style="font-family: Courier New,Courier,monospace;"></span></small>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;<br>&lt;html&gt;<br>    &lt;head&gt;<br>        &lt;meta content="text/html; charset=Big5" http-equiv="content-type"&gt;<br>        &lt;style type="text/css"&gt;<br>            #container {<br>                color: #ffffff;<br>                background-color: #ff0000;<br>                border-width: 10px;<br>                border-color: black;<br>                border-style: solid;<br>                width: 100px;<br>                height: 50px;<br>                padding: 50px;<br>                position: absolute;<br>                top: 50px;<br>                left: 50px;<br>            }<br>            #message {<br>                position: static;<br>                top: 20px;<br>                left: 20px;<br>            }<br>        &lt;/style&gt;<br>        &lt;script type="text/javascript"&gt;<br>            window.onload = function(event) {<br><span style="font-weight: bold;">                function offset(element) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    var x = 0;</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    var y = 0;</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    while(element) {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        x += element.offsetLeft;</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        y += element.offsetTop;</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        element = element.offsetParent;</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    }</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    return { </span><br style="font-weight: bold;"><span style="font-weight: bold;">                        x: x, </span><br style="font-weight: bold;"><span style="font-weight: bold;">                        y: y, </span><br style="font-weight: bold;"><span style="font-weight: bold;">                        toString: function() {</span><br style="font-weight: bold;"><span style="font-weight: bold;">                            return '(' + this.x + ', ' + this.y + ')';</span><br style="font-weight: bold;"><span style="font-weight: bold;">                        }</span><br style="font-weight: bold;"><span style="font-weight: bold;">                    };</span><br style="font-weight: bold;"><span style="font-weight: bold;">                }</span><br>                <br>                document.onclick = function(event) {<br>                    event = event || window.event;<br>                    var container = document.getElementById('container');<br>                    container.style.left = event.clientX + 'px';<br>                    container.style.top = event.clientY + 'px';<br>                    var message = document.getElementById('message');<br>                    var console = document.getElementById('console');<br>                    console.innerHTML = offset(message);<br>                };                <br>            };<br>        &lt;/script&gt;        <br>    &lt;/head&gt;<br>    &lt;body&gt;<br>        &lt;div id="container"&gt;&lt;span id="message"&gt;這是一段訊息&lt;span&gt;&lt;/div&gt;<br>        &lt;span id="console"&gt;&lt;/span&gt;<br>    &lt;/body&gt;<br>&lt;/html&gt;<br></pre>
      <small><span style="font-family: Courier New,Courier,monospace;"></span></small><small><span style="font-family: Courier New,Courier,monospace;"><br>
一個需要元素確實位置的例子，就是像搜尋框中出現的提示，你需要知道搜尋框的位置，將傳回的關鍵字建議顯示在搜尋框下方。下面這個例子是個簡單示範：<br>
</span></small>
      <ul>
        <li><a href="samples/TopLeft-3.html"><small>TopLeft-3.html</small></a></li>
      </ul>
      <pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"&gt;<br>&lt;html&gt;<br>    &lt;head&gt;<br>        &lt;meta content="text/html; charset=Big5" http-equiv="content-type"&gt;<br>        &lt;style type="text/css"&gt;<br>            #container {<br>                color: #ffffff;<br>                background-color: #ff0000;<br>                height: 50px;<br>                position: absolute;<br>                top: -100px;<br>                left:-100px;<br>            }<br>        &lt;/style&gt;<br>        &lt;script type="text/javascript"&gt;<br>            window.onload = function(event) {<br>                function offset(element) {<br>                    var x = 0;<br>                    var y = 0;<br>                    while(element) {<br>                        x += element.offsetLeft;<br>                        y += element.offsetTop;<br>                        element = element.offsetParent;<br>                    }<br>                    return { <br>                        x: x, <br>                        y: y, <br>                        toString: function() {<br>                            return '(' + this.x + ', ' + this.y + ')';<br>                        }<br>                    };<br>                }<br>                var input = document.getElementById('search');<br>                var search = offset(input);<br>                var container = document.getElementById('container');<br>                container.style.left = search.x + 'px';<br>                container.style.top = search.y + input.offsetHeight + 'px';<br>                container.style.width = input.offsetWidth + 'px';<br>            };<br>        &lt;/script&gt;        <br>    &lt;/head&gt;<br>    &lt;body&gt;<br>        &lt;div id="container"&gt;這是一段訊息&lt;/div&gt;<br>        &lt;hr&gt;<br>        搜尋：&lt;input id="search" type="text"&gt;<br>    &lt;/body&gt;<br>&lt;/html&gt;<br></pre>
      <small><span style="font-family: Courier New,Courier,monospace;"><br>不幸地，offsetParent存在瀏覽器差異性，在</span>Firefox上，<span style="font-family: Courier New,Courier,monospace;">就absolute、fixed的元素而言，offsetParent是&lt;body&gt;標籤，就static、relative而言，就是</span></small><small><span style="font-family: Courier New,Courier,monospace;">元素的所有父階層中，第一個可用來作為位置參考的節點，但</span><span style="font-family: Courier New,Courier,monospace;">relative的設定</span></small><small><span style="font-family: Courier New,Courier,monospace;">在</span>不同的Internet Explore<span style="font-family: Courier New,Courier,monospace;">r版本上</span></small><small><span style="font-family: Courier New,Courier,monospace;">，所取得的offsetParent各不相同</span></small><small><span style="font-family: Courier New,Courier,monospace;">。<br>
      <br>
另外，在更複雜的排版下，取得元素精確位置所要考慮的事情會更複雜，例如，</span>CSS<span style="font-family: Courier New,Courier,monospace;">的overflow設定可建立捲軸，偏移量不會考慮捲軸位置，如果使用了overflow設定，必須再考慮捲軸值。例如：<br>
      </span></small>
      <div style="margin-left: 40px;"><small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">function offset(element) {</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; var x = 0;</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; var y = 0;</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; for(var e = element; e; e = e.offsetParent) {</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></small><small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">x += e.offsetLeft;</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y += e.offsetTop;</span></small><br style="font-weight: bold;">
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; }<br>
      <br>
      </span></small><small><small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;"></span></small>&nbsp;<span style="font-weight: bold;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; 修正捲軸區域的量</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; for(var e = element.parentNode; e &amp;&amp; e != document.body; e = e.parentNode) {</span></small><small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;"></span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">
      </span></small><small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(e.scrollLeft) {</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x -= e.scrollLeft;</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;"></span></small><small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(e.scrollTop) {</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y -= e.scrollTop;</span></small><br>
      <small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></small><small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;"></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; return { </span></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x: x, </span></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y: y, </span></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toString: function() {</span></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return '(' + this.x + ', ' + this.y + ')';</span></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; };</span></span></small><br style="font-weight: bold;">
      <small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></span></small><br>
      <small><span style="font-family: Courier New,Courier,monospace;"></span></small></div>
      <br>
      <small><span style="font-family: Courier New,Courier,monospace;">
      <br>
      </span></small>
<br>
</td>

    </tr>

  </tbody>
</table><br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/JavaScript/TopLeft.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:39 GMT -->
</html>