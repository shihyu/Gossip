<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/Ruby/Numeric.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:15:42 GMT -->
<head>


















  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>數值型態</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">Ruby Gossip: 數值型態<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>
      <br></td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>在Ruby中，數值都是<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">Numeric</span>的子類別實例，<span style="font-family: Courier New,Courier,monospace;">Numeric</span>的子類別有<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">Integer</span>代表整數、<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">Float</span>代表浮點數，Integer又<span style="font-family: Courier New,Courier,monospace;">有代表固定長度整數的<span style="font-weight: bold;">Fixnum</span>與超長整數的<span style="font-weight: bold;">Bignum</span></span>。<br>
      </small>
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Numeric</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |-Integer</span></small><br>
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp; &nbsp;&nbsp;&nbsp; |-Fixnum</span></small><br>
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp; &nbsp;&nbsp; |-Bignum</span></small><br>
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |-Float</span></small><br>
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;"></span></small></div>
      <small><br>
在Ruby中，所有的資料都是物件，但可以使用實字（Literal）方式來撰寫表示數值，</small><small>直接寫下一個整數值，預設是十進位整數，如果要撰寫二進位實字，則在數字前前<span style="font-weight: bold; font-family: Courier New,Courier,monospace;">0b</span>，如果要撰寫八進位實字，則在數字前置<span style="font-weight: bold; font-family: Courier New,Courier,monospace;">0</span>，之後接上1到7的數字，如果要撰寫十六進位整數，則以<span style="font-weight: bold; font-family: Courier New,Courier,monospace;">0x</span>開頭，之後接上1到9、A到F。例如：</small><small><br></small>
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">











        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 10</span><br>
=&gt; 10<br><span style="font-weight: bold;">
&gt;&gt; 0b10</span><br>
=&gt; 2<br><span style="font-weight: bold;">
&gt;&gt; 010</span><br>
=&gt; 8<br><span style="font-weight: bold;">
&gt;&gt; 0x10</span><br>
=&gt; 16<br><span style="font-weight: bold;">
&gt;&gt;</span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      </table>






      <br>
      <small><span style="font-family: Courier New,Courier,monospace;">Fixnum可容納的長度依機器而有所不同，如果撰寫的整數超出Fixnum可容納的長度，會自動轉換為Bignum，所以基本上不用特別在意兩者的差別：</span></small><small><br></small>
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">












        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 1.class</span><br>
=&gt; Fixnum<br><span style="font-weight: bold;">
&gt;&gt; 1111111111111111111111111111111111111111111111111111111111111.class</span><br>
=&gt; Bignum<br><span style="font-weight: bold;">
&gt;&gt;</span><br>
</span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      </table>







      <br>
      <small>可以使用<span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span>字串、浮點數的<span style="font-weight: bold;">to_i</span>方法建立整數，如果是字串，to_i可以指定</span>以二進位、八進位或十六進位將字串代表的數值傳回<small>，</small>事實上，你可以在呼叫<span style="font-family: Courier New,Courier,monospace;">to_i</span>時，指定2到36作為基底。</small><small>。例如：</small><small><br></small>
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">













        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);">&gt;&gt; "10".to_i<br>
=&gt; 10<br>
&gt;&gt; 3.14.to_i<br>
=&gt; 3<br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; "10".to_i(2)</span><br>
=&gt; 2<br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; "10".to_i(8)</span><br>
=&gt; 8<br><span style="font-weight: bold;">
&gt;&gt; "10".to_i(16)</span><br>
=&gt; 16<br><span style="font-weight: bold;">
&gt;&gt; "10".to_i(17)</span><br>
=&gt; 17<br><span style="font-weight: bold;">
&gt;&gt;</span><br>
            </span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      </table>








      <br>
      <small>兩個整數相除，結果仍會是整數，如果想要有浮點數結果，則其中一個運算元必須是浮點數。例如：</small><small><br></small>
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">














        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 10 / 3</span><br>
=&gt; 3<br><span style="font-weight: bold;">
&gt;&gt; 10.0 / 3</span><br>
=&gt; 3.33333333333333<br><span style="font-weight: bold;">
&gt;&gt; 10 % 3</span><br>
=&gt; 1<br><span style="font-weight: bold;">
&gt;&gt;</span><br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);">
      </span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      </table>









      <br>
      <small>在上例中，<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">/</span>是除法操作，<span style="font-weight: bold;">%</span>則是取得除法後的餘數。</small><small>除了/與%之外，<span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">+</span>、<span style="font-weight: bold;">-</span>、<span style="font-weight: bold;">*</span></span>等都可以運用在數值上，另外還有<span style="font-weight: bold; font-family: Courier New,Courier,monospace;">**</span>次方運算。例如要計算2的100次方：</small><small><br></small>
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 2 ** 100</span><br>=&gt; 1267650600228229401496703205376<br><span style="font-weight: bold;">
&gt;&gt;</span><br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);">
      </span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      </table>










      <br>
      <small>可以直接寫下3.14這樣的數值作為浮點數，它們會是<span style="font-family: Courier New,Courier,monospace;">Float</span>實例，</small><small>可以使用<span style="font-family: Courier New,Courier,monospace;">3.14e-10</span>這樣的表示法。例如：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 3.14</span><br>=&gt; 3.14<br><span style="font-weight: bold;">
&gt;&gt; 3.14e-10.class</span><br>
=&gt; Float<br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);">
      </span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      
      </table>











      <br>
      <small style="font-family: Courier New,Courier,monospace;">類似地，也可以使用整數、字串的<span style="font-weight: bold;">to_f</span>方法建立浮點數。例如：</small><small><br></small>
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">

















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; "3.14159".to_f</span><br>
=&gt; 3.14159<br><span style="font-weight: bold;">
&gt;&gt; "2.1e-10".to_f</span><br>
=&gt; 2.1e-010<br><span style="font-weight: bold;">
&gt;&gt;</span><br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);">
      </span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      
      
      </table>












      <br>

      <small>使用浮點數，同樣要注意浮點數精度問題，例如：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">

















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 1.0 - 0.8</span><br>
=&gt; 0.19999999999999996<br><span style="font-weight: bold;">
&gt;&gt; 7.3 - 7.2 == 0.1</span><br>
=&gt; false<br><span style="font-weight: bold;">
&gt;&gt; 7.3 - 7.2</span><br>
=&gt; 0.0999999999999996<br><span style="font-weight: bold;">
&gt;&gt; 1.2 - 1.0 - 0.2 == 0.0</span><br>
=&gt; false<br><span style="font-weight: bold;">
&gt;&gt; 1.2 - 1.0 - 0.2</span><br>
=&gt; -5.55111512312578e-017<br><span style="font-weight: bold;">
&gt;&gt;</span><br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);">
      </span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      
      </table>












      <br>
      <small>開發人員基本上都要</small><small>了解CPU處理浮點數的設計原理，</small><small>如果你要精確的結果，那麼可以使用<span style="font-weight: bold; font-family: Courier New,Courier,monospace;">bigdecimal</span><span style="font-family: Courier New,Courier,monospace;">中</span><span style="font-family: Courier New,Courier,monospace;">的</span><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">BigDecimal</span>類別。例如：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">


















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; require "bigdecimal"</span><br>
=&gt; true<br><span style="font-weight: bold;">
&gt;&gt; a = BigDecimal.new("7.3")</span><br>
=&gt; #&lt;BigDecimal:22bde60,'0.73E1',8(8)&gt;<br><span style="font-weight: bold;">
&gt;&gt; b = BigDecimal.new("7.2")</span><br>
=&gt; #&lt;BigDecimal:2173c20,'0.72E1',8(8)&gt;<br><span style="font-weight: bold;">
&gt;&gt; r = BigDecimal.new("0.1")</span><br>
=&gt; #&lt;BigDecimal:22548c0,'0.1E0',4(8)&gt;<br><span style="font-weight: bold;">
&gt;&gt; a - b == r</span><br>
=&gt; true<br><span style="font-weight: bold;">
&gt;&gt; (a - b).to_f</span><br>
=&gt; 0.1<br><span style="font-weight: bold;">
&gt;&gt;</span><br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);">
      </span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      
      </table>













      <br>
      <small>這解決了問題，但寫法較為冗長，可以要求<span style="font-family: Courier New,Courier,monospace;">bigdecimal中的<span style="font-weight: bold;">util</span></span>特性，這會為<span style="font-family: Courier New,Courier,monospace;">Float增加<span style="font-weight: bold;">to_d</span>方法，可以直接取得BigDecimal實例。例如：</span></small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">



















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; require "bigdecimal/util"</span><br>
=&gt; true<br><span style="font-weight: bold;">&gt;&gt; 1.2.to_d</span><br>
=&gt; #&lt;BigDecimal:2424d20,'0.12E1',8(8)&gt;<br><span style="font-weight: bold;">
&gt;&gt; 1.2.to_d - 1.0.to_d - 0.2.to_d == 0.0.to_d</span><br>
=&gt; true<br><span style="font-weight: bold;">
&gt;&gt; (1.2.to_d - 1.0.to_d - 0.2.to_d).to_f</span><br>
=&gt; 0.0<br><span style="font-weight: bold;">
&gt;&gt;</span><br>
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);">
      </span></small><span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      
      </table>














      <br>
      <br>
      <small>
      <br>
      </small>
</td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/Ruby/Numeric.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:15:42 GMT -->
</html>