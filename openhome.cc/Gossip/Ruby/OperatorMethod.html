<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/Ruby/OperatorMethod.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:15:42 GMT -->
<head>
















  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>操作方法</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">Ruby Gossip: 操作方法<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>
<script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><center> </center></td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>現在已經看過幾個運算操作了，最基本的就是<span style="font-family: Courier New,Courier,monospace;">+、-、*、/</span>操作，當他們用在數值運算時是較為直覺的加、減、乘、除操作。不過，<span style="font-family: Courier New,Courier,monospace;">+</span>在Ruby的物件上，往往可以作串接物件的作用，例如串接字串、串接陣列等，結果都是產生新的物件傳回：</small><small><br></small>
      
      
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">











        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; "Just" + "in"<br>
</span>=&gt; "Justin"<span style="font-weight: bold;"><br>
&gt;&gt; [1, 2] + [3, 4]<br>
            </span>=&gt; [1, 2, 3, 4]<span style="font-weight: bold;"><br>
&gt;&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      
      </table>



      <br>

      <small><span style="font-family: Courier New,Courier,monospace;">*</span>在Ruby上，則通常可以作加倍的動作，例如：</small><small><br></small>
      
      
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">












        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; "Justin" * 4<br>
</span>=&gt; "JustinJustinJustinJustin"<span style="font-weight: bold;"><br>
&gt;&gt; [1, 2] * 4<br>
            </span>=&gt; [1, 2, 1, 2, 1, 2, 1, 2]<span style="font-weight: bold;"><br>
&gt;&gt;</span></span></small></td></tr></tbody>
      
      </table>

      <br>
      <small>如果要作數值次方運算，則使用**。</small><small>例如：</small><small><br></small>
      
      
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">













        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 9 ** 2<br>
</span>=&gt; 81<span style="font-weight: bold;"><br>
&gt;&gt; 9 ** 3<br>
            </span>=&gt; 729<span style="font-weight: bold;"><br>
&gt;&gt; 9 ** 0.5<br>
            </span>=&gt; 3.0<span style="font-weight: bold;"><br>
&gt;&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      
      </table>


      <br>
      <small>Ruby還提供了關係運算（Rational operation）、邏輯運算（Logical operation）、位元運算（Bitwise operation）等對物件的運算操作：</small><br>
      <ul style="font-family: Courier New,Courier,monospace;">
<li><small>關係運算：如&gt;、&gt;=、&lt;、&lt;=、==、!=、&lt;=&gt;</small></li><li><small>邏輯運算：如and與&amp;&amp;、or與||、not與!</small></li><li><small>位
元運算：如&amp;、|、~、^、&gt;&gt;、&lt;&lt;</small></li>
        <li><small>指
定運算：如</small><small>+=、-=、*=、/=、%=、</small><small>&amp;=、|=、~=、^=、&gt;&gt;=、&lt;&lt;=...</small></li>

      </ul>
      <br><small>其中可作為單元運算的有+、-、~、!等。不僅僅是數值可以使用這些運算操作，在適當的場合，特定的物件也可以使用這些運算操作，例如陣列可以使用&amp;、<span style="font-family: Courier New,Courier,monospace;">|</span>來作交集、聯集操作，可以參考 </small><small><big><a href="Array.html"><small>陣列型態</small></a></big> </small><small>的說明。<br>
      <br>
Ruby中比較特別的是擁有<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&lt;=&gt;</span>運算操作，如果左運算元等於右運算元會傳回0，大於傳回1，小於傳回-1。例如：</small><small><br></small>
      
      
      
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">














        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 1 &lt;=&gt; 1<br>
</span>=&gt; 0<span style="font-weight: bold;"><br>
&gt;&gt; 1 &lt;=&gt; 2<br>
            </span>=&gt; -1<span style="font-weight: bold;"><br>
&gt;&gt; 2 &lt;=&gt; 1<br>
            </span>=&gt; 1<span style="font-weight: bold;"><br>
&gt;&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      
      
      </table>



      <small><br>
      </small><small>在現階段，你可以先知道的是，有些運算操作在物件的動作，其實是可以透過定義方法（Method）來決定該如何進行處理。<span style="font-family: Courier New,Courier,monospace;">例如+可以定義+()方法，而%可以定義%()方法</span>：</small>
      
      
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">














        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; 1.methods<br>
</span>=&gt; [:to_s, :-@, :+, :-, :*, :/, :div, :%, :modulo, :divmod, :fdiv, :**, :abs, :m<br>
agnitude, :==, :===, :&lt;=&gt;, :&gt;, :&gt;=, :&lt;, :&lt;=, :~, :&amp;, :|, :^, :[], :&lt;&lt;, :&gt;&gt;, ..<br>
..略]<span style="font-weight: bold;"><br>
&gt;&gt; 1 + 2<br>
            </span>=&gt; 3<span style="font-weight: bold;"><br>
&gt;&gt; 1.+(2)<br>
            </span>=&gt; 3<span style="font-weight: bold;"><br>
&gt;&gt; 10 % 3<br>
            </span>=&gt; 1<span style="font-weight: bold;"><br>
&gt;&gt; 10.%(3)<br>
            </span>=&gt; 1<span style="font-weight: bold;"><br>
&gt;&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      
      </table>



      <br>
      <small style="font-family: Courier New,Courier,monospace;">就算是<span style="font-weight: bold;">[]</span>索引運算操作，也是可以透過對應的<span style="font-weight: bold;">[]()</span>、<span style="font-weight: bold;">[]=()</span>來定義：</small><small><br></small>
      
      
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; [].methods<br>
</span>=&gt; [:inspect, :to_s, :to_a, :to_ary, :frozen?, :==, :eql?, :hash, :[], :[]=, :at<br>
, :fetch, :first, :last, :concat, :&lt;&lt;, ...略]<span style="font-weight: bold;"><br>
&gt;&gt; x = [1, 2, 3]<br>
            </span>=&gt; [1, 2, 3]<span style="font-weight: bold;"><br>
&gt;&gt; x[1]<br>
            </span>=&gt; 2<span style="font-weight: bold;"><br>
&gt;&gt; x.[](1)<br>
            </span>=&gt; 2<span style="font-weight: bold;"><br>
&gt;&gt; x[2]<br>
            </span>=&gt; 3<span style="font-weight: bold;"><br>
&gt;&gt; x.[](2)<br>
            </span>=&gt; 3<span style="font-weight: bold;"><br>
&gt;&gt; x[0] = 10<br>
            </span>=&gt; 10<span style="font-weight: bold;"><br>
&gt;&gt; x.[]=(1, 20)<br>
            </span>=&gt; 20<span style="font-weight: bold;"><br>
&gt;&gt; x<br>
            </span>=&gt; [10, 20, 3]<span style="font-weight: bold;"><br>
&gt;&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      
      </table>





      <br>
      <small>單元運算的方法名稱比較特殊，為運算字元後加上<span style="font-weight: bold; font-family: Courier New,Courier,monospace;">@</span>。例如：</small><small><br></small>
      
      
      
      
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">

















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; -1<br>
</span>=&gt; -1<span style="font-weight: bold;"><br>
&gt;&gt; 1.-@()<br>
            </span>=&gt; -1<span style="font-weight: bold;"><br>
&gt;&gt; +1<br>
            </span>=&gt; 1<span style="font-weight: bold;"><br>
&gt;&gt; 1.+@()<br>
            </span>=&gt; 1<span style="font-weight: bold;"><br>
&gt;&gt; ~10<br>
            </span>=&gt; -11<span style="font-weight: bold;"><br>
&gt;&gt; 10.~@()<br>
            </span>=&gt; -11<span style="font-weight: bold;"><br>
&gt;&gt; ! true<br>
            </span>=&gt; false<span style="font-weight: bold;"><br>
&gt;&gt; true.!@()<br>
            </span>=&gt; false<span style="font-weight: bold;"><br>
&gt;&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      
      
      </table>






      <br>
      <small style="font-family: Courier New,Courier,monospace;">要注意，=不能
使用方法定義，所以其它如+=、-=...等也不能使用方法定義，&amp;&amp;與||具有捷徑運算，你也無法用方法定義，因此&amp;
&amp;=與||=也無法使用方法定義。可以使用方法定義的運算操作有+、-、*、/、%、[]、[]=、&lt;&lt;、&gt;&gt;、==、
&gt;、&lt;、&gt;=、&lt;=、===、&amp;、|、^、~、!。<br>
      </small><br>
<small>初學目前僅需了解到這邊，在了解如何自定義類別之後，將會再介紹如何定義這些特定的方法，事實上，在 </small><small><big><a href="Array.html"><small>陣列型態</small></a> <small>中也看過一個自定義 <span style="font-family: Courier New,Courier,monospace;">^</span> 運算操作的例子：</small></big></small><small><br></small>
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">












        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; class Array<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp; def ^(that)<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self + that - (self &amp; that)<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp; end<br>
&gt;&gt; end<br>
</span>=&gt; nil<span style="font-weight: bold;"><br>
&gt;&gt; admins = ["Justin", "caterpillar"]<br>
=&gt; ["Justin", "caterpillar"]<br>
&gt;&gt; users = ["momor", "hamini", "Justin"]<br>
      =&gt; ["momor", "hamini", "Justin"]<br></span></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; admins ^ users<br></span>
=&gt; ["caterpillar", "momor", "hamini"]<span style="font-weight: bold;"><br>
&gt;&gt;</span></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;"></span><span style="font-weight: bold;">&nbsp;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;"></span><br>




            </span></td></tr></tbody>
      
      
      
      </table>







      <br>
      <small>在使用邏輯運算<span style="font-family: Courier New,Courier,monospace;">and與&amp;&amp;、or與||、not與!</span>時，要注意到，</small><small><span style="font-weight: bold;">在Ruby中，除了</span><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">nil與false</span><span style="font-weight: bold;">為假之外，其它物件都會被評估為真</span><span style="font-weight: bold;">。</span>例如字<span style="font-family: Courier New,Courier,monospace;">串'Justin'在判斷式中會是真，而空字串""也是物件，在判斷式中會是真，所以空陣列是真、空雜湊是真、而<span style="font-weight: bold;">0</span>也是真。例如：</span></small><small><br></small>
      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">













        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; if 0<br>
&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp; puts "0"<br>
&gt;&gt; end<br>
</span>0<span style="font-weight: bold;"><br>
            </span>=&gt; nil</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;"><br>
&gt;&gt;</span></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;"></span><span style="font-weight: bold;">&nbsp;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;"></span><br>




            </span></td></tr></tbody>
      
      
      
      </table>








      <br>
      <small>因此可以利用這個特性，撰寫以下程式：<br>
      </small>
      <ul>
        <li>main.rb</li>
      </ul>
      <pre>if ARGV[0]<br>    name = ARGV[0]<br>else<br>    name = "Guest"<br>end<br><br>puts "Hello, #{name}!"<br></pre>
      <br>
      <small style="font-family: Courier New,Courier,monospace;">如果使用者有輸入命令列引數，則ARGV[0]會有字串，就將name設定為使用者指定的命令列引數，否則ARGV[0]會是nil，結果就是判斷為假，就將name設定為"Guest"。例如：</small><small><span style="font-family: Courier New,Courier,monospace;"></span></small><br>


      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">



















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;ruby main.rb Justin<br>
            </span>Hello, Justin!<span style="font-weight: bold;"><br>
            <br>
&gt;ruby main.rb<br>
            </span>Hello, Guest!<span style="font-weight: bold;"><br>
            <br>
&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      
      
      </table>








      <br>
      <small><span style="font-family: Courier New,Courier,monospace;">and與&amp;&amp;、or與||有捷徑運算，and與&amp;&amp;左運算元若判定為假，則就不會繼續運算右運算元，or與||則是左運算元判斷為真，則不的運算右運算元。當判斷確認時停在哪個運算元，就會傳回該運算元，例如：</span></small><br>

      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">


















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt; nil &amp;&amp; "Justin"<br>
</span>=&gt; nil<span style="font-weight: bold;"><br>
&gt;&gt; true &amp;&amp; "Justin"<br>
            </span>=&gt; "Justin"<span style="font-weight: bold;"><br>
&gt;&gt; nil || "Justin"<br>
            </span>=&gt; "Justin"<span style="font-weight: bold;"><br>
&gt;&gt; "Monica" || "Justin"<br>
            </span>=&gt; "Monica"<span style="font-weight: bold;"><br>
&gt;&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      
      
      </table>







      <br>
      <small>利用這個特性，先前的範例程式，可以改寫為以下：<br>
      </small>
      <ul>
        <li>main.rb</li>
      </ul>
      <pre>name = ARGV[0] || "Guest"<br>puts "Hello, #{name}!"<br></pre>
      <br>
      <br>
      <br>
<br>
</td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/Ruby/OperatorMethod.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:15:42 GMT -->
</html>