<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/JavaScript/FunctionInstance.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:22 GMT -->
<head>


















  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>Function 實例</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">JavaScript Essence: Function 實例<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><center> </center></td>

      <td style="vertical-align: top; width: 690px; text-align: left;">
      <div style="text-align: right;"><a href="http://openhome.cc/eGossip/JavaScript/FunctionInstances.html">English</a></div>
      <small><br>
在JavaScript中，函式是物件，是<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">Function</span><span style="font-weight: bold;">的實例</span>。因為是<span style="font-family: Courier New,Courier,monospace;">Function</span>實例，你可以將之傳給另一個變數參考。例如：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">







        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; function max(num1, num2) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; return num1 &gt; num2 ? num1 : num2;<br>
&nbsp; &gt; }<br>
js&gt; var maximum = max;<br>
js&gt; max(10, 20);<br>
</span>20<span style="font-weight: bold;"><br>
js&gt; maximum(10, 20);<br>
            </span>20<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>


      <small><br style="font-family: Courier New,Courier,monospace;"><span style="font-family: Courier New,Courier,monospace;">注意，在將max指定給maximum時，max後並沒有加上()運算子，這表示要將max參考的物件指定給maximum參考（加上括號表示要執行函式）。將一個函式指定給變數，這看來如果覺得奇怪的話，或許下這個看來比較不奇怪：</span></small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">








        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; var max = function(num1, num2) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; return num1 &gt; num2 ? num1 : num2;<br>
&nbsp; &gt; };<br>
js&gt; var maximum = max;<br>
js&gt; max(1, 2);<br>
</span>2<span style="font-weight: bold;"><br>
js&gt; maximum(1, 2);<br>
            </span>2<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>



      <small><br style="font-family: Courier New,Courier,monospace;">上面你所看到的函式撰寫方式，稱之為<span style="font-weight: bold;">函式實字（Function literal）</span>，這就像你寫下一個數值實字、物件實字或陣列實字，會產生數值或物件等：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">var number = 10;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">var obj = { x : 10 };</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">var array = [1, 2, 3];</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">var func = function() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; // do something...</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">};</span></small><br>
      </div>
      <small><br>
函式實字會產生<span style="font-family: Courier New,Courier,monospace;">Function</span>實例，在JavaScript中，無論是函式宣告或函式實字，都會產生Function實例。事實上，你也可以直接指定建立<span style="font-family: Courier New,Courier,monospace;">Function</span>實例：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">









        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; var max = new Function('num1', 'num2', 'return num1 &gt; num2 ? num1 : num2');<br>
js&gt; max(5, 6);<br>
</span>6<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>




      <small><br style="font-family: Courier New,Courier,monospace;">基本上，實務上很少會直接建立<span style="font-family: Courier New,Courier,monospace;">Function</span>實例，以上只是表示，函式確實是<span style="font-family: Courier New,Courier,monospace;">Function</span>實例。<br>
      <br>
即然函式是物件，它就可以任意指定給其它變數，也就可以指定作為另一個函式的引數，那它就不僅能被呼叫，還可以主動要求另一個函式執行所指定的函式內容。例如：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">










        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; var printIt = function(element) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; print(element);<br>
&nbsp; &gt; };<br>
js&gt; [1, 2, 3].forEach(printIt);<br>
</span>1<br>
2<br>
3<span style="font-weight: bold;"><br>
js&gt; var comparator = function(num1, num2) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; return num1 - num2;<br>
&nbsp; &gt; };<br>
js&gt; [5, 1, 7, 3, 2].sort(comparator);<br>
            </span>1,2,3,5,7<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>





      <small><br style="font-family: Courier New,Courier,monospace;"><span style="font-family: Courier New,Courier,monospace;">上
例以Array為例，forEach可以對陣列的每個元素作「某些事」，「某些事」是由你使用函式來指定，陣列會逐一將元素傳入給你指定的函式作為引數。
sort則可以進行排序，但兩個元素的大小關係要由你告知，傳回正值表示傳入的num1順序上大於num2，要排在num2的後面，傳回0表示兩個順序相
同，傳回負值表示</span></small><small><span style="font-family: Courier New,Courier,monospace;">num1順序上小於num2，要排在num2的前面。<br>
      <br>
</span>像這種將函式主動丟入函式作為引數，在JavaScript中是很常見到的應用<span style="font-family: Courier New,Courier,monospace;">。事實上，若不需要名稱，你也可以如下：</span></small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">











        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; [1, 2, 3].forEach(function(element) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; print(element);<br>
&nbsp; &gt; });<br>
</span>1<br>
2<br>
3<span style="font-weight: bold;"><br>
js&gt; [5, 1, 7, 3, 2].sort(function(num1, num2) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; return num1 - num2;<br>
&nbsp; &gt; });<br>
            </span>1,2,3,5,7<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>






      <small><br>
你也可以從函式中傳回函式，這通常會形成閉包（Closure）綁定某些運算過後的資源，再傳回函式，這之後還會再談到應用。<br>
<br style="font-family: Courier New,Courier,monospace;">以函式實字所建立的<span style="font-family: Courier New,Courier,monospace;">Function</span>實例，在指定給別的變數前，稱為所謂的<span style="font-weight: bold;">匿名函式（Anonymous function）</span>。你可以完全不使用名稱來執行函式：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">












        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; (function() {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; print('anonymous function...');<br>
&nbsp; &gt; })();<br>
</span>anonymous function...<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>







      <small><br style="font-family: Courier New,Courier,monospace;">實際上，函式實字也可以指定名稱。例如：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">













        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; var maximum = function max(num1, num2) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; return num1 &gt; num2 ? num1 : num2;<br>
&nbsp; &gt; };<br>
js&gt; maximum(10, 20);<br>
</span>20<span style="font-weight: bold;"><br>
js&gt; max(10, 20);<br>
            </span>js: "&lt;stdin&gt;", line 6: uncaught JavaScript runtime exception: ReferenceError: "max" is not defined.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at &lt;stdin&gt;:6<span style="font-weight: bold;"><br>
            <br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>








      <small><br style="font-family: Courier New,Courier,monospace;">上例中，函式實字所建立的<span style="font-family: Courier New,Courier,monospace;">max</span>名稱，似乎不能使用，事實上，這種語法適用於使用函式實字建立<span style="font-family: Courier New,Courier,monospace;">Function</span>實例，但又需遞迴的場合。例如：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">














        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; var gcd = function g(num1, num2) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; return num2 != 0 ? g(num2, num1 % num2) : num1;<br>
&nbsp; &gt; };<br>
js&gt; gcd(10, 5);<br>
</span>5<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>









      <small><br>
      </small><small><span style="font-family: Courier New,Courier,monospace;">在一個匿名函式中，如果想取得本身實例，可以藉由<span style="font-weight: bold;">arguments</span>的<span style="font-weight: bold;">callee</span>來取得。例如：</span></small><br>
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; var gcd = function(num1, num2) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; return num2 != 0 ? arguments.callee(num2, num1 % num2) : num1;<br>
&nbsp; &gt; };<br>
js&gt; gcd(20, 10);<br>
</span>10<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      
      </table>











      <small><small><br style="font-family: Courier New,Courier,monospace;"></small></small><small><br>
函式既然是物件，本身亦可擁有特性。例如函式有個<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">length</span>特性，代表其參數個數：</small><small><br></small>
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; var gcd = function g(num1, num2) {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; return num2 != 0 ? g(num2, num1 % num2) : num1;<br>
&nbsp; &gt; };<br>
</span></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">
js&gt; gcd.length;<br>
</span>2<span style="font-weight: bold;"><br>
js&gt;</span></span></small><br>
<span style="color: rgb(255, 255, 255);">




            </span></td></tr></tbody>
      
      
      </table>










      <small><small><br style="font-family: Courier New,Courier,monospace;"><span style="font-family: Courier New,Courier,monospace;"></span></small>函式也可以擁有方法，這個之後再談，你也可以在其上新增特性或方法，就如同一個普通的物件。<br>
      </small><small><br>
函式宣告與函式實字在運用上，幾乎是相同的，但還是有細微的差別。例如，你若寫一個f.js檔案如下：<br>
      </small>
      <ul>
        <li>f.js</li>
      </ul>
      <pre>func();<br>function func() {<br>    print('func');<br>} <br></pre>
      <small><br>
      </small><small>直接使用Rhino直譯器載入執行的話，可以正常執行：</small><br>
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">your_workspace&gt; java org.mozilla.javascript.tools.shell.Main f.js<br>
</span>func<span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>











      <small><span style="font-family: Courier New,Courier,monospace;"></span><small><br>
      </small>但如果你的f.js如下：<br>
      </small>
      <ul>
        <li>f.js<br>
        </li>
      </ul>
      <pre>func();<br>var func = function() {<br>    print('func');<br>};<br></pre>
      <br>
      <small>你會得到錯誤的訊息：</small><br>

      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">

















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">your_workspace&gt; java org.mozilla.javascript.tools.shell.Main f.js<br>
</span>js: uncaught JavaScript runtime exception: TypeError: func is not a function, it is undefined.<span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>












      <small><small><span style="font-family: Courier New,Courier,monospace;"></span><small><br>
</small></small><span style="font-family: Courier New,Courier,monospace;">錯誤訊息告訴你，func值是undefined。原因在於，直譯器在載入</span>.js<span style="font-family: Courier New,Courier,monospace;">時，會先處理所有的宣告，包括變數與函式宣告，接著再執行程式。所以在第一個</span>f.js中，是以函式宣告方式，直譯器已處理完成，因此接下來再執行時，就可以<span style="font-family: Courier New,Courier,monospace;">找到func所參考的函式。<br>
      <br>
而在第二個f.js中，僅宣告了func變數，直譯器處理完這個宣告後，接下來要執行程式時，範圍中可以看到func變數，但此時還沒有指定值給func，所以是undefined，因此不能完成函式的執行。<br>
      <br>
雖然不重要，但還是提一下的是，以上兩種方式，在遇到要建立函式實例時，都不會再重新直譯，但如果你以直接建構Function實例的方式，則每次都會針對你引數的字串再作直譯動作。<br>
      </span></small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">var max = new Function('num1', 'num2', 'return num1 &gt; num2 ? num1 : num2');</span></small><br>
      </div>
      <br>
      <small>函式宣告方式所建立的函式名稱，其實也是範圍物件上的特性名稱。例如若在全域範圍宣告：</small><br>


      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">


















        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small style="font-family: Courier New,Courier,monospace;"><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">js&gt; function func() {<br>
&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; print('func');<br>
&nbsp; &gt; }<br>
js&gt; func();<br>
            </span>func<span style="font-weight: bold;"><br>
js&gt; this.func();<br>
            </span>func<span style="font-weight: bold;"><br>
js&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      
      
      </table>













      <small style="font-family: Courier New,Courier,monospace;"><small><small><small><br>
</small></small></small>可以看到，func名稱是全域物件上的特性。</small><br>
      <small><br>
      </small><a href="http://openhome.cc/eGossip/JavaScript/FunctionInstances.html"></a><br>
</td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/JavaScript/FunctionInstance.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:22 GMT -->
</html>