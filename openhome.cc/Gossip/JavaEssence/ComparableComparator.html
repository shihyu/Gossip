<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/JavaEssence/ComparableComparator.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:13:55 GMT -->
<head>



  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">

  <link rel="stylesheet" href="css/print.css" type="text/css">

  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>請排隊</title></head><body>

<h3><a href="../index.html">From
Gossip@Openhome</a></h3>

<h1><a href="index-2.html">Java Essence: 請排隊</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="width: 250px; text-align: center; vertical-align: top;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js"></script><br>

      <br>
<script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js"></script><br>

      <br>

      </td>

      <td style="vertical-align: top; width: 690px; text-align: left;">在 <small><big><a href="Collection.html"><small>Collection</small></a></big> 中談到TreeSet，會將你加入的物件進行排序，預設使用<span style="font-weight: bold;">自然順序（Natural order）</span>。例如：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Set set = new TreeSet();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">set.add("Justin");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">set.add("Bush");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">set.add("Momor");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">System.out.println(set);</span></small><br style="font-weight: bold;">
      </div>
      <br>
      <small>最後顯示的順序是[Bush, Justin, Momor]。如果你定義了Student類別：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Student {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private String name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private int score;</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public Student(String name, int score) {</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this.name = name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this.score = score;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public String getName() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int getScore() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return score;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; } <br>
&nbsp;&nbsp;&nbsp; public String toString() {<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return "Student [name=" + name + ", score=" + score + "]";<br>
&nbsp;&nbsp;&nbsp; }<br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      </span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br>
      </div>
      <small><br>
然後這麼新增至TreeSet：<br>
      </small>
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">Set set = new TreeSet();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">set.add(new Student("Justin", 96));</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">set.add(new Student("Bush", 88));</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">set.add(new Student("Momor", 93));</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">System.out.println(set);</span></small><br>
      </div>
      <small><br>
那在第二次新增Student實例時會引發<span style="font-weight: bold;">ClassCastException</span>的錯誤，先不論引發例外的原因為何，你並沒有告訴TreeSet，是要根據學生名稱，還是根據學生分數排序不是嗎？<br>
      <br>
可以試著讓Student實作<span style="font-weight: bold;">Comparable</span>介面：<br>
      </small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Student <span style="color: red;">implements Comparable&lt;Student&gt;</span> {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private String name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private int score;</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public Student(String name, int score) {</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this.name = name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this.score = score;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public String getName() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return name;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int getScore() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return score;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">

      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; } <br>
&nbsp;&nbsp;&nbsp; public String toString() {<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return "Student [name=" + name + ", score=" + score + "]";<br>
&nbsp;&nbsp;&nbsp; }<br>
      <span style="color: red;">&nbsp;&nbsp;&nbsp; public int compareTo(Student other) {</span><br style="color: red;">
      <span style="color: red;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return this.score - other.score;</span><br style="color: red;">
      <span style="color: red;">&nbsp;&nbsp;&nbsp; }</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br>
      <small><br>
Comparable有個<span style="font-weight: bold;">compareTo()</span>方法要實作，它會傳
入一個物件，你要傳回大於0、0或小於0的數。傳回大於0表示，傳入的物件順序上比目前物件大，應該排在後面，傳回0表示兩個物件順序上相等，傳回小於0
表示傳入的物件順序上比目前物件小，應該排在前面。就上例而言，會根據學生的分數由小到大排序。重新執行上面新增學生的程式片段，結果會顯示
[Student [name=Bush, score=88], Student [name=Momor, score=93], Student
[name=Justin, score=96]]。<br>
      <br>
所以，當你使用TreeSet新增物件時，TreeSet會預期新增的物件都必須實作Comparable介面，在嘗試比較兩個物件時，其實就會試著將新
增的物件轉型（Cast）為Comparable型態，再用compareTo()進行比較。所以先前未實作Comparable的Student在新增
至TreeSet時，就會引發ClassCastException，原因就在此。<br>
      <br>
排序時根據物件上的Comparable介面定義之順序，就稱之<span style="font-weight: bold;">自然順序（Natural order）</span>。事實上，String就實作了Comparable介面，所以你可以直接將字串加入TreeSet，就是這個原因。<br>
      <br>
然而有時候，你並不是有辦法讓物件實作Comparable介面，例如String就是了，你不能改變String，也不能繼承String並實作
Comparable介面，若你想讓TreeSet排序字串時以與先前相反的順序該如何？你可以在建立TreeSet時，指定一個Comparator實
作物件。例如：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Set set = new TreeSet(<span style="color: red;">new Comparator&lt;String&gt;() {</span></span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public int compare(String s1, String s2) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return -s1.compareTo(s2);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"><span style="color: red;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span>);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">set.add("Justin");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">set.add("Bush");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">set.add("Momor");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">System.out.println(set);</span></small><br>
      </div>
      <small><br>
Comparator有一個compare()方法要實作，它會傳入兩個物件，同樣地，你要傳回</small><small>你要傳回大於0、0或小於0的數。傳回大於0表示，左邊傳入的物件順序上比右邊傳入物件大，應該排在後面，傳回0表示兩個物件順序上相等，傳回小於0表示左邊傳入的物件順序上比右邊傳入物件小，應該排在前面。上例會顯示[Momor, Justin, Bush]。<br>
      <br>
如果你不想用TreeSet排序，則可以將物件新增至List，再使用Collections的sort()方法進行排序。你可以使用自然順序。例如以下顯示</small><small>[Bush, Justin, Momor]</small><small>：<br style="font-weight: bold;">
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">List&lt;String&gt; list = new ArrayList&lt;String&gt;();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">list.add("Justin");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">list.add("Bush");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">list.add("Momor");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">Collections.sort(list);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">System.out.println(list);</span></small><br>
      </div>
      <small><br>
或者是給定一個Comparator，例如以下顯示</small><small>[Momor, Justin, Bush]</small><small>：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">List&lt;String&gt; list = new ArrayList&lt;String&gt;();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">list.add("Justin");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">list.add("Bush");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">list.add("Momor");</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">Collections.sort(list, new Comparator&lt;String&gt;() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public int compare(String s1, String s2) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return -s1.compareTo(s2);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  </span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">
      <small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; });</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">System.out.println(list);</span></small><br>
      </div>
      <small><br>
      </small><small><br>
      </small>
</td>

    </tr>

  </tbody>
</table>

<br>

<br>

<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script>
</body>
<!-- Mirrored from openhome.cc/Gossip/JavaEssence/ComparableComparator.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:13:55 GMT -->
</html>