<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/Scala/UsingScalaInJava.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:11:14 GMT -->
<head>







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type">







  
  
  
  
  
  
  
  <title>在 Java 中使用 Scala 類別</title></head>
<body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">Scala Gossip: 在 Java 中使用 Scala 類別</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;"><script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>
      <br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><center> </center></td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>若
是在JVM平台上，Scala的類別會編譯為.class檔案，基本上在Java程式中，也可以使用這些編譯好的.class檔，不過由於某些Scala
的語法特性，在Java中並不存在，因此若要在Java程式中使用Scala所編譯好的類別，就必須注意一些語法或名稱對應的方式。<br><br>當你在Scala中定義一個類別：<br></small><pre>class Some</pre><small><br>使用scalac編譯後會產生Some.class檔案，若你想要在Java中使用這個Some類別：<br></small><pre>public class Main {  // 這是 Java<br>    public static void main(String[] args) {<br>        Some s = new Some();<br>    }<br>}</pre><small><br>你可以編譯Main.java，但在執行時若沒有指定Classpath中包括scala-library.jar的位置，就會出現錯誤：<br></small><table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">




        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">&gt;javac Main.java<br><br>&gt;java Main<br>Exception in thread "main" java.lang.NoClassDefFoundError: scala/ScalaObject<br>....</span></small></td></tr></tbody></table><br><small>這是因為，Scala中的自定義類別，會實作scala.ScalaObject特徵，也就是編譯出來的.class，其實相當於：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> <span style="color: red;">implements ScalaObject</span></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; public int $tag()</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> throws RemoteException</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; return ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br style="font-weight: bold;"></div><small><br>若要能順利執行，則必須指定Classpath包括scala-library.jar的位置：</small><small><br></small><table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">




        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">&gt;java -cp .;%SCALA_HOME%/lib/scala-library.jar Main<br></span></small></td></tr></tbody></table><br><small>在定義類別時，使用val宣告的變數，對應至Java使用final修飾的變數。如果是類別的資料成員，無論是使用val宣告或var宣告的變數，一律對應至private資料成員，在Scala中提供的權限修飾，對應至相對應的存取方法權限。例如：<br></small><pre>class Some {<br>    private var m = 123<br>    private val s = "XD"<br>}</pre><small><br>編譯過後的.class會是：<br style="font-weight: bold;"></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some implements ScalaObject {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private int m;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private final String s = "XD"</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public Some() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; super();</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m = 123;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private void m_$eq(int x$1) { m = x$1; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private int m() { return m; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; private String s() { return s; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return scala.ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>所以，如果是這個類別：<br></small><pre>class Some {<br>    val s = "XD"<br>}</pre><small><br>在Java中要取得s的值，則必須呼叫方法，例如：<br></small><pre>public class Main { // 這是 Java<br>    public static void main(String[] args) {<br>        Some some = new Some();<br>        System.out.println(some.s());<br>    }<br>}</pre><small><br>如果你希望編譯過後的類別具有設值方法（Setter）與取值方法（Getter），則可以使用 @BeanProperty 標註，請參考<big> </big></small><small><big><a href="Annotation.html"><small>標註（Annotation）</small></a></big> 的內容。</small><br><small><br>在Scala中所有東西都是物件，就算是1、0.1等數值也是物件，而在編譯為.class之後，為了效率，會儘量將數值轉為Java的基本資料型態，而在必要的地方使用Integer等包裹類別（Wrapper）。例如：<br></small><pre>class Some {<br>    def doIt(a: Int): Int = {<br>        val l = new java.util.ArrayList[Int]<br>        l.add(a)<br>        return l.get(0)<br>    }<br>}</pre><br><small>這個類別在編譯為.class之後，相當於：<br></small><div style="margin-left: 40px;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">import java.rmi.RemoteException;</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">import java.util.ArrayList;</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">import scala.ScalaObject;</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">import scala.runtime.BoxesRunTime;</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">public class Some&nbsp;implements ScalaObject {</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; public <span style="color: red;">int</span> doIt(<span style="color: red;">int</span> a)&nbsp; {</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; ArrayList l = new ArrayList();</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; l.add(<span style="color: red;">BoxesRunTime.boxToInteger(a)</span>);</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; return <span style="color: red;">BoxesRunTime.unboxToInt(l.get(0))</span>;</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; }</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; public int $tag()&nbsp; throws RemoteException {</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; return ScalaObject.class.$tag(this);</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp; }</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">}</small><br></div><br><small>在
參數與傳回值的型態部份轉為int，而必要的地方使用裝箱（Boxing）與拆箱（Unboxing）。在Scala中如果設定參數型態或傳回值型態為
Any、AnyRef或AnyVal，編譯.class後，都對應於java.lang.Object。如果傳回值設定為AnyVal，則傳回的數值會裝
箱，例如：<br></small><pre>class Some {<br>    def doSomething(a: AnyVal): AnyVal = 1<br>}</pre><br><small>這個類別在編譯過後，.class的定義基本上如下：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.runtime.BoxesRunTime;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some implements ScalaObject {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public Some() {}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public <span style="color: red;">Object</span> doSomething(<span style="color: red;">Object</span> a) {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return <span style="color: red;">BoxesRunTime.boxToInteger(1)</span>;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return scala.ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br></small><small>Scala的 <big><a href="SingletonObject.html"><small>單
例物件</small></a><small> 在Java中，可以使用存取靜態成員的方式來使用，例如：<br></small></big></small><pre>object Some {<br>    def doSomething = "XD"<br>}</pre><br><small>在Java中可以這麼使用：</small><small><br></small><pre>public class Main {  // 這是 Java<br>    public static void main(String[] args) {<br>        System.out.println(Some.doSomething()); // XD<br>    }<br>}</pre><small><br>不過別誤以為單例物件轉換為Java之後，單例物件的名稱就是類別名稱，其中的成員直接就是實作為靜態成員！不然會誤入這個陷阱：<br></small><pre>class Some<br><br>object Some {<br>    def doSomething = "XD"<br>}</pre><br><small>上面定義了伴侶類別與伴侶物件，在編譯過後，</small><small>在Java中這麼使用是會有錯的：</small><small><br></small><pre>public class Main {  // 這是 Java<br>    public static void main(String[] args) {<br>        System.out.println(Some.doSomething()); // 編譯錯誤<br>    }<br>}</pre><small><br>其實，只要是Scala中使用object定義的物件，在轉換為.class後，其實真正的類別名稱是「單例物件名$」，</small><small>該類別中會有個MODULE$成員參考到this，</small><small>例如上面的例子會產生Some$類別，其定義為：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public final class <span style="color: red;">Some$</span> implements ScalaObject {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public Some$() {}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public String doSomething() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "XD";</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return scala.ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public static final Some$ MODULE$ = this;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; static {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new Some$();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>在沒有伴侶類別的情況下，編譯會產生一個Some類別定義如下：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public final class Some {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; <span style="color: red;">public static final String doSomething() {</span></span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Some$.MODULE$.doSomething();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public static final int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Some$.MODULE$.$tag();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>這也是為何你可以在Java中使用Some.doSometing()的原因。然而在有伴侶類別的情況下，所產生的Some類別定義會是：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some implements ScalaObject {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public Some() {}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return scala.ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>這也是為什麼，</small><small>你不可以在Java中使用Some.doSometing()的原因。無論是否有伴侶類別，其實想要在Java中使用Scala單例物件中定義的成員，方式都是：<br></small><pre>public class Main {  // 這是 Java<br>    public static void main(String[] args) {<br>        Some$.MODULE$.doSomething();<br>    }<br>}</pre><br><small>在Scala中若設定建構式為private或其它權限，例如：<br></small><pre>class Some private {}</pre><small><br>編譯為.class後，基本上建構式也會被標示為相對應的權限，例如.class的定義會是：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some implements ScalaObject{</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; <span style="color: red;">private</span> Some() {}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return scala.ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>但若出現伴侶物件且嘗試建構物件時，編譯過後的.class，private就不是private了。例如：<br></small><pre>class Some private {<br>}<br><br>object Some {<br>    def apply = new Some<br>}</pre><small><br>在上例中，Some在編譯過後，其.class的定義會是：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some implements ScalaObject {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; <span style="color: red;">public</span> Some() {}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return scala.ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>在Scala中有特徵（Trait），特徵可以有實作，在Java中要使用Scala中的特徵所編譯過來的.class，最簡單的方式，是就是在Scala中定義沒有任何實作的特徵，如此編譯過去的.class，就是對應至Java的介面（Interface）。例如：<br></small><pre>trait Some {<br>    def doIt(a: Any): Any<br>}</pre><small><br>在編譯為.class後，會對應至以下的Java介面：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public <span style="color: red;">interface</span> Some {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public abstract Object doIt(Object obj);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>有實作的特徵在Java中沒有直接對應的語法，可以得到如Scala中直接具有實作特徵的好處。真的要使用具實作的特徵編譯出來的.class還是有辦法的，不過只會讓Java中的程式更為複雜，所以並不鼓勵，這在之後的文件還會介紹。<br></small><small><br>Scala的 </small><small><a href="TypeParameterization.html">型態參數</a> 對應至Java的泛型（Generic）語法，由於Java並不支援 </small><small><a href="Covariance.html">共變性（Covariance）</a> 與 </small><small><a href="Contravariance.html">逆變性（Contravariance）</a>，在Scala中如果定義型態參數時標註了正變或逆變，編譯之後的.class是不會包含任何正變、逆變資訊的。例如：<br></small><pre>class Fruit<br>class Apple extends Fruit<br>class Some[+T]<br>class Util {<br>    val sf: Some[Fruit] = new Some[Apple]<br>}</pre><small><br>編譯之後的.class定義分別如下：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">// Some.class</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some<span style="color: red;">&lt;T&gt;</span> implements ScalaObject {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; public int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; return ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">// Util.class</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Util</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> implements ScalaObject</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> {</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; private final Some<span style="color: red;">&lt;Fruit&gt;</span> sf;</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; public Util()</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> {</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; this.sf = <span style="color: red;">new Some()</span>; <br>&nbsp;&nbsp;} </span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; public Some<span style="color: red;">&lt;Fruit&gt;</span> sf() { return this.sf;</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> }</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"></span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; public int $tag()</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> throws RemoteException</span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"> {</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; return ScalaObject.class.$tag(this);</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; }</span></small><br style="font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br><small><span style="font-weight: bold;"></span></small></div><small><br>如果使用了 </small><small><a href="ExistentialType.html">既存型態（Existential type）</a>，編譯後的.class，會對應至Java的型態通配字元語法。例如：<br></small><pre>class Util {<br>    val sf: Some[_ &lt;: Fruit] = new Some[Apple]<br>}</pre><small><br></small><small>在編譯為.class後，定義如下：<br style="font-weight: bold;"></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">import scala.ScalaObject;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Util implements ScalaObject {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; private final Some<span style="color: red;">&lt;? extends Fruit&gt;</span> sf;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; public Util() {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; this.sf = new Some(); </span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; } </span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; public Some<span style="color: red;">&lt;? extends Fruit&gt;</span> sf() { return this.sf; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; public int $tag() throws RemoteException {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; return ScalaObject.class.$tag(this);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; }</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br><br><br></small></td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/Scala/UsingScalaInJava.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:11:14 GMT -->
</html>