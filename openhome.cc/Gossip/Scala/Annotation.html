<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/Scala/Annotation.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:11:14 GMT -->
<head>







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type">







  
  
  
  
  
  
  
  <title>標註（Annotation）</title></head>
<body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">Scala Gossip: 標註（Annotation）</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>
      <br></td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>標註（Annotation）是撰寫在原始碼中的資訊，可以提供程式碼以外的額外資訊，與註解不同的是，標註本身有其結構，</small><small>你可以使用工具提取這些結構化訊息。<br><br>Scala本身提供一些標註，可提供編譯器或運行平台（JVM）使用所加註的訊息，如果平台是JVM，在Java中所撰寫的標註，也可以使用在Scala的語法之中。<br><br>以下簡介Scala本身所提供的幾個標註。首先是<span style="font-weight: bold;">@deprecated</span>，也許你原先撰寫了某個類別或函式，別人也使用了你撰寫的類別或函式，但之後你發現該類別或函式有些不適當的地方（也許是效能、安全等問題），為了向前相容性，你不可以直接移除該類別或函式，以免已使用你所撰寫的類別或函式的客戶端，突然發現他們找不到該類別或函式了。<br><br>你可以在類別或函式上標註@deprecated，例如：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"><span style="color: red;">@deprecated</span> class Some {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; ...</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"><span style="color: red;">@deprecated</span> def someFunc = {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; ....</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}<br><br>class Other {<br></span></small><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;"><span style="color: red;">&nbsp; &nbsp; @deprecated</span> def otherFunc = {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; ...</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp; &nbsp; }</span></small><br><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}<br></span></small></div><small><br>如果客戶端再度使用了你所提供的這些類別或函式，則編譯時會出現以下的訊息，提醒他們使用了不再建議使用的API：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">warning: there were deprecation warnings; re-run with -deprecation for details one warning found</span></small><br></div><small><br>如果運行的平台是在JVM，則Scala的編譯器會將@deprectated轉換為Java的@Deprecated標註，如此若你在Java中使用了Scala所編譯出來的類別，使用Java編譯器時也會出現警示訊息。<br><br>Scala的標註也可以用於運算式（Expression），例如在<big> </big></small><small><big><a href="SealedClass.html"><small>密封類別（Sealed class）</small></a></big> 中看過的例子，當編譯器好意提出一些你未注意到的檢查狀況時的警示訊息，而你不想再看到這些囉嗦的訊息時，</small><small>可以使用 <span style="font-weight: bold;">@unchecked</span> 標註（Annotation）來告訴編譯器住嘴：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">...</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">def what(d: Drawing) = (d: @unchecked) match {</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; case Point(_, _)&nbsp;&nbsp;&nbsp; =&gt; "點"</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; case Cylinder(_, _) =&gt; "柱"</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br style="font-weight: bold;"></div><small><br></small><small>當你要在多執行緒環境下共用存取某個類別的可變狀態資料成員</small><small>（Field）</small><small>時，可將該成員標註為<span style="font-weight: bold;">@volatile</span>，這告訴編譯器，該成員會在多執行緒環境下被共用存取，如果運行的環境為JVM，編譯器會將@volatile轉為Java語法的volatile修飾字。<br><br>Scala本身不提供序列化機制，然而提供了三個與序列化有關的標註：<span style="font-weight: bold;">@serializable</span>、<span style="font-weight: bold;">@SerialVersionUID</span>以及<span style="font-weight: bold;">@transient</span>。
這三個標註告知底層平台哪些類別可以進行序列化、其序列化版本識別為何以及哪些成員（Field）不用序列化。如果是在JVM平台上，
@serializable將對應至實作java.io.Serializable介面，@SerialVersionUID將對應至final
static的serialVersionUID，而@transient將對應至transient關鍵字。<br><br></small><small>如果是在JVM上，</small><small><span style="font-weight: bold;">@clonable</span>將對應至實作java.lang.Clonable介面，</small><small><span style="font-weight: bold;">@remote</span>將對應至實作java.rmi.Remote介面。<br><br>Scala本身並不需要JavaBean形式的設值方法（Setter）與取值方法（Getter），在JVM平台上，如果你想要Scala的類別編譯出來後，其可變資料成員自動生成設值與取值方法，則可以使用<span style="font-weight: bold;">@scala.reflect.BeanProperty</span>，例如：<br></small><pre>import <span style="font-weight: bold;">scala.reflect.BeanProperty</span><br>class Some {<br><span style="font-weight: bold;">    @BeanProperty</span> private var x = 10<br>}</pre><small><br>這個類別在使用scalac編譯之後，若使用Java的javap指令，可以看到以下的資訊：<br></small><div style="margin-left: 40px;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">public class Some extends java.lang.Object implements scala.ScalaObject{</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; public Some();</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp; public void setX(int);</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace; color: red;">&nbsp;&nbsp;&nbsp; public int getX();</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; public int $tag()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throws java.rmi.RemoteException;</small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-weight: bold; font-family: Courier New,Courier,monospace;">}</small><br></div><small><br>在Scala中並不區分受檢例外（Checked exception）與非受檢例外（Unchecked exception），因此你可以撰寫類似以下的程式碼：<br></small><pre>import java.io._<br><br>class Some {<br>    def writeTo(file: String) {<br>        val writer = new BufferedWriter(new FileWriter(file));<br>        writer.write("...");<br>        writer.close();<br>    }<br>}</pre><small><br>若平台是JVM，編譯這個類別後，使用Java的javap指令，可以看到writeTo()方法並沒有throws宣告：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some extends java.lang.Object implements scala.ScalaObject{</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public Some();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public void writeTo(java.lang.String);</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int $tag()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throws java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>在Java
的程式碼中仍然可以使用這個編譯好的類別（因為受檢例外是編譯器檢查，而非JVM的驗證器），Scala沒有throws語句，若你想要編譯出來的類別，
可以在writeTo()方法上宣告throws
IOException，以便在Java程式中使用到writeTo()方法時，編譯器可以檢查是否處理IOException，則你可以使用<span style="font-weight: bold;">@throws</span>標註，例如：<br></small><pre>import java.io._<br><br>class Some {<br><span style="font-weight: bold;">    @throws(classOf[IOException]) </span><br>    def writeTo(file: String) {<br>        val writer = new BufferedWriter(new FileWriter(file));<br>        writer.write("...");<br>        writer.close();<br>    }<br>}</pre><small><br></small><small>編譯這個類別後，使用Java的javap指令，可以看到writeTo()方法已加上throws宣告：<br></small><div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">public class Some extends java.lang.Object implements scala.ScalaObject{</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public Some();</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public void writeTo(java.lang.String)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: red;">throws java.io.IOException</span>;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; public int $tag()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throws java.rmi.RemoteException;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">}</span></small><br></div><small><br>Scala本身並不提供撰寫標註的機制，其所提供的標註僅提供底層平台轉換時的一些資訊，如果你的平台是JVM，那麼你可以使用Java的標註撰寫語法，將撰寫好的標註使用在Scala之中。<br></small><small><br><br></small><small><br></small></td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();</script><br><br></body>
<!-- Mirrored from openhome.cc/Gossip/Scala/Annotation.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:11:14 GMT -->
</html>