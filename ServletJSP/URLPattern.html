<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/ServletJSP/URLPattern.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:53 GMT -->
<head>

















  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>URL 模式</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">Servlet/JSP Gossip: URL 模式<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;"> <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br><center> </center></td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>一個請求URI實際上是由三個部份所組成，你可以使用<span style="font-family: Courier New,Courier,monospace;">HttpServletRequest的<span style="font-weight: bold;">getRequestURI()</span></span>來取得：<br>
      </small>
      
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace; color: red;"><span style="font-weight: bold;">requestURI = contextPath + servletPath + pathInfo</span></small><br>
      </div>

      <small><br>
其中<span style="font-family: Courier New,Courier,monospace; font-weight: bold; color: red;">contextPath</span><span style="color: red;">是</span><span style="font-weight: bold; color: red;">環境路徑（Context path）</span>，是<span style="font-weight: bold;">容器用來決定該挑選哪個Web應用程式的依據</span>（一個容器上可能部署多個Web應用程式），環境路徑的設定並非標準，依伺服器實作而有所不同。例如在Glassfish v3中，可以設定sun-web.xml的<span style="font-family: Courier New,Courier,monospace;">&lt;context-root&gt;</span>來決定。<br>
      <br>
</small><small>你可使用<span style="font-family: Courier New,Courier,monospace;">HttpServletRequest的<span style="font-weight: bold;">getContextPath()</span></span>來取得。如果應用程式環境路徑與Web伺服器環境根路徑相同，則</small><small>應用程式環境路徑</small><small>為空字串，如果不是，則</small><small>應用程式環境路徑以<span style="font-family: Courier New,Courier,monospace;">/</span>開頭，不包括<span style="font-family: Courier New,Courier,monospace;">/</span>結尾。<br>
      <br>
一旦決定是哪個Web應用程式來處理請求，接下來就進行Servlet的挑選，Servlet必須設定<span style="font-weight: bold; color: red;">URL模式（URL pattern）</span>，可以設定的格式是：<br>
      </small>
      <ul>
        <li><small><span style="font-family: Courier New,Courier,monospace;">"</span><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">/</span><span style="font-family: Courier New,Courier,monospace;">"</span>開頭但<span style="font-family: Courier New,Courier,monospace;">"</span><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">/*</span><span style="font-family: Courier New,Courier,monospace;">"</span>結尾的URL模式被用於<span style="font-weight: bold;">路徑對應（Path mapping）</span>。例如若設定URL模式為<span style="font-family: Courier New,Courier,monospace;">"/guest/*"</span>，則請求URI扣去環境路徑的部份若為/<span style="font-family: Courier New,Courier,monospace;">guest/test.view、</span></small><small><span style="font-family: Courier New,Courier,monospace;">/guest/home.view等以/guest/</span>作為開頭的，都會交由該Servlet處理。</small></li>
        <li><small>以<span style="font-weight: bold; font-family: Courier New,Courier,monospace;">"*."</span>開頭的URL模式被用於<span style="font-weight: bold;">延伸對應（extension mapping）</span>。例如若URL模式設定為<span style="font-family: Courier New,Courier,monospace;">"*.view"</span>，則所有以<span style="font-family: Courier New,Courier,monospace;">.view</span>結尾的請求，都會交由該Servlet處理。</small></li>
        <li><small>空字串<span style="font-family: Courier New,Courier,monospace;">""是個特殊</span>的URL模式，對應至<span style="font-weight: bold;">環境根目錄（Context root）</span>，也就是<span style="font-family: Courier New,Courier,monospace;">/的請求，但不用於設置&lt;url-pattern&gt;或urlPattern屬性。例如若環境根目錄為App，則http://host:port/App/</span>的請求，路徑資訊是/，而Servlet路徑與環境路徑都是空字串。</small></li>
        <li><small>僅包括<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">"/"</span>的URL模式，表示<span style="font-weight: bold;">預設Servlet</span>，當找不到適合的URL模式對應時，就會使用預設Servlet。</small></li>
        <li><small>其它的字串設定，都是用在於<span style="font-weight: bold;">嚴格匹配（Exact match）</span>。</small></li>
      </ul>
      <small><br>
如果URL模式在設定比對的規則在某些URL請求時有所重疊，例如若有<span style="font-family: Courier New,Courier,monospace;">"/admin/login.do"、"/admin/*"與"*.do"</span>三個URL模式設定，則請求時比對的原則是從最嚴格的URL模式開始符合。如果你請求<span style="font-family: Courier New,Courier,monospace;">/admin/login.do</span>，則一定是由URL模式設定<span style="font-family: Courier New,Courier,monospace;">為/admin/login.do的Servlet來處理，而不會是/admin/*或*.do。如果你請求/admin/setup.do，則是由/admin/*的Servlet來處理，而不會是*.do。</span><br>
      <br>
      </small><small>在最上面的<span style="font-family: Courier New,Courier,monospace;">requestURI中，<span style="font-weight: bold; color: red;">servletPath</span><span style="color: red;">的</span></span><span style="color: red;">部份是指</span><span style="font-weight: bold; color: red;">Servlet路徑（Servlet path）</span>，不包括路徑資訊（Path info）與請求參數（Request parameter）。</small><small>Servlet路徑直接對應至URL模式資訊，可使用<span style="font-family: Courier New,Courier,monospace;">HttpServletRequest的<span style="font-weight: bold;">getServletPath()</span></span>來取得，<span style="font-weight: bold;">Servlet路徑基本上是以</span><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">"/"開頭，</span></small><small style="font-weight: bold;"><span style="font-family: Courier New,Courier,monospace;">但"/*"與""</span>的URL模式比對而來的請求除外，在</small><small><span style="font-family: Courier New,Courier,monospace; font-weight: bold;">"/*"與""</span><span style="font-weight: bold;">的情況下，Servlet路徑是空字串。</span><br>
      <br>
      </small><small>例如若某個請求是根據<span style="font-family: Courier New,Courier,monospace;">"/hello.do"</span>對應至Servlet，則Servlet路徑就是<span style="font-family: Courier New,Courier,monospace;">"/hello.do"，如果是透過"/servlet/*"對應至</span>Servlet，則Servlet<span style="font-family: Courier New,Courier,monospace;">路徑就是/servlet，但如果是透過"/*"或""</span>，則Servlet路徑就是空字串。</small><br>
      <small><span style="font-weight: bold;"><br>
      </span></small><small>在最上面的<span style="font-family: Courier New,Courier,monospace;">requestURI中，<span style="font-weight: bold; color: red;">pathInfo</span><span style="color: red;">的</span></span><span style="color: red;">部份是指</span><span style="font-weight: bold; color: red;">路徑資訊（Path info）</span>，路徑資訊不包括請求參數，指的是</small><small>不包括Context Path與Servlet Path部份的額外路徑資訊。</small><small>可使用<span style="font-family: Courier New,Courier,monospace;">HttpServletRequest的<span style="font-weight: bold;">getPathInfo()</span></span>來取得。<span style="font-weight: bold;">如果沒有額外</span></small><small style="font-weight: bold;">路徑</small><small style="font-weight: bold;">資訊，則為<span style="font-family: Courier New,Courier,monospace;">null（延伸對應、預設</span><span style="font-family: monospace;">Servlet</span><span style="font-family: Courier New,Courier,monospace;">、嚴格匹配的情況下），如果有額外</span></small><small style="font-weight: bold;">路徑</small><small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">資訊，則是個以"/"為開頭的字串。</span><br>
      <br>
</span></small><small><span style="font-weight: bold;"></span></small><small>例如若對以下的Servlet請求之URL為 http://localhost:8080/ServletDemo/servlet/path.view ：<br>
      </small>
      
      <pre>package cc.openhome;<br><br>import java.io.*;<br>import javax.servlet.*;<br>import javax.servlet.annotation.*;<br>import javax.servlet.http.*;<br><br>@WebServlet(name="Path", <span style="font-weight: bold;">urlPatterns={"/servlet/*"}</span>)<br>public class Path extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp)<br>            throws ServletException, IOException {<br>                PrintWriter out = resp.getWriter();<br>        out.println("&lt;html&gt;");<br>        out.println("    &lt;head&gt;");<br>        out.println("        &lt;title&gt;Servlet ShowHeader&lt;/title&gt;");<br>        out.println("    &lt;/head&gt;");<br>        out.println("    &lt;body&gt;");<br>        out.println(        req.getRequestURI() + "&lt;br&gt;");<br>        out.println(        req.getContextPath() + "&lt;br&gt;");<br>        out.println(        req.getServletPath() + "&lt;br&gt;");<br>        out.println(        req.getPathInfo());<br>        out.println("    &lt;/body&gt;");<br>        out.println("&lt;/html&gt;");<br>        out.close();<br>    }<br>}<br></pre>

      <br>

      <small>則會顯示以下的內容：</small><br>

      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&lt;html&gt;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; &lt;head&gt;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;title&gt;Servlet ShowHeader&lt;/title&gt;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; &lt;/head&gt;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; &lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /ServletDemo/servlet/path.view&lt;br&gt;<br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      </span><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /ServletDemo&lt;br&gt;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /servlet&lt;br&gt;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /path.view</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; &lt;/body&gt;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&lt;/html&gt;</span></small><br>
      </div>

      <br>
      <small>URL模式如果重複，在Tomcat上會以後載入者為主，在Glassfish中則會直接發生錯誤。</small><br>
<br>
</td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/ServletJSP/URLPattern.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:16:53 GMT -->
</html>