<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/ServletJSP/SetOutTag.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:17:54 GMT -->
<head>


















  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>屬性處理與輸出標籤</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">Servlet/JSP Gossip: 屬性處理與輸出標籤<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br>      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>
</td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>JSP的<span style="font-family: Courier New,Courier,monospace;">&lt;jsp:setProperty&gt;</span>功能有限，只能用來設定JavaBean的屬性。如果想要在<span style="font-family: Courier New,Courier,monospace;">page、request、session、application等範圍設定一個屬性，或者想要設定Map物件的鍵與值，則可以使用<span style="font-weight: bold;">&lt;c:set&gt;</span>標籤。</span><br>
      <br>
      <span style="font-family: Courier New,Courier,monospace;">例如使用者登入後，想要在session範圍中設定一個"login"屬性，代表使用者已經登入，則可以如下撰寫：</span><br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&lt;c:set var="login" value="caterpillar" scope="session"/&gt;</small><br>
      </div>
      <small><br>
      <span style="font-family: Courier New,Courier,monospace;">var用來設定屬性名稱，而value用來設定屬性值。這段標籤設定的作用，相當於：</span><br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;% session.setAttribute("login", "caterpillar"); %&gt;</span></small><br>
      </div>
      <small><br>
也可以使用EL來進行設定，例如：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;c:set var="login" value="${user}" scope="session"/&gt;</span></small><br>
      </div>
      <small><br>
      <span style="font-family: Courier New,Courier,monospace;">如果${user}運算的結果是User類別的實例，則儲存的屬性就是User物件，也就是相當於以下這段程式碼：</span><br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;%</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; // user是User所宣告的參考名稱，參考至User物件</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; session.setAttribute("login", user); </span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">%&gt;</span></small><br>
      </div>
      <small><br>
      <span style="font-family: Courier New,Courier,monospace;">&lt;c:set&gt;標籤也可以將value的設定改為本體的方式，在所要設定的屬性值冗長時，採用本體的方式會比較容易撰寫。例如：</span><br style="font-family: Courier New,Courier,monospace;">
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;c:set var="details" scope="session"&gt;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; caterpillar,openhome.cc,caterpillar.onlyfun.net</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;/c:set&gt;</span></small><br>
      </div>
      <small><br>
      <span style="font-family: Courier New,Courier,monospace;">&lt;c:set&gt;
不設定scope時，則會以page、request、session、application的範圍尋找屬性名稱，如果在某個範圍找到屬性名稱，則在該
範圍設定屬性。如果所有範圍都沒有找到屬性名稱，則會在page範圍中新增屬性。如果要移除某個屬性，則可以使用<span style="font-weight: bold;">&lt;c:remove&gt;</span>標籤。例如：</span><br style="font-family: Courier New,Courier,monospace;">
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;c:remove var="login" scope="session"/&gt;</span></small><br>
      </div>
      <small><br>
      <span style="font-family: Courier New,Courier,monospace;">&lt;c:set&gt;</span>也可以直接用來設定JavaBean的屬性或是<span style="font-family: Courier New,Courier,monospace;">Map</span>物件的鍵／值，要設定JavaBean或<span style="font-family: Courier New,Courier,monospace;">Map</span>物件，必須使用<span style="font-family: Courier New,Courier,monospace;">target屬性進行設定。例如：</span><br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;c:set target="${user}" property="name" value="${param.name}"/&gt;</span></small><br>
      </div>
      <small><br>
如果<span style="font-family: Courier New,Courier,monospace;">${user}</span>運算出來的結果是個JavaBean，則上例就如同呼叫<span style="font-family: Courier New,Courier,monospace;">setName()並將請求參數name的值傳入。如果${user}運算出來的結果是個Map，則上例就是以property屬性作為鍵，而value屬性作為值來呼叫Map物件的put()方法。<br>
      <br>
      </span>&nbsp;下面這個範例改寫自 </small><small><big><a href="HttpSession.html"><small>使用 HttpSession</small></a></big> </small><small>的問卷網頁，把Servlet改為JSP實作，並且使用JSTL來設置屬性：<br>
      </small>
      <pre>&lt;%@page contentType="text/html" pageEncoding="UTF-8"%&gt;<br>&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;<br>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"<br>"http://www.w3.org/TR/html4/loose.dtd"&gt;<br>&lt;c:set target="${pageContext.request}"<br>         property="characterEncoding" value="UTF-8"/&gt;<br>&lt;html&gt;<br>    &lt;head&gt;<br>        &lt;meta http-equiv="Content-Type"<br>                 content="text/html; charset=UTF-8"&gt;<br>        &lt;title&gt;Questionnaire&lt;/title&gt;<br>    &lt;/head&gt;<br>    &lt;body&gt;<br>        &lt;form action="question.jsp" method="post"&gt;<br>            &lt;c:choose&gt;<br>                &lt;c:when test="${param.page == 'page1'}"&gt;<br>                    問題一：&lt;input type="text" name="p1q1"&gt;&lt;br&gt;<br>                    問題二：&lt;input type="text" name="p1q2"&gt;&lt;br&gt;<br>                    &lt;input type="submit" name="page" value="page2"&gt;<br>                &lt;/c:when&gt;<br>                &lt;c:when test="${param.page == 'page2'}"&gt;<br>                    &lt;c:set var="p1q1" <br>                            value="${param.p1q1}" scope="session"/&gt;<br>                    &lt;c:set var="p1q2"<br>                             value="${param.p1q2}" scope="session"/&gt;<br>                    問題三：&lt;input type="text" name="p2q1"&gt;&lt;br&gt;<br>                    &lt;input type="submit" name="page" value="finish"&gt;<br>                &lt;/c:when&gt;<br>                &lt;c:when test="${param.page == 'finish'}"&gt;<br>                    ${sessionScope.p1q1}&lt;br&gt;<br>                    ${sessionScope.p1q2}&lt;br&gt;<br>                    ${param.p2q1}&lt;br&gt;<br>                &lt;/c:when&gt;<br>            &lt;/c:choose&gt;<br>        &lt;/form&gt;<br>    &lt;/body&gt;<br>&lt;/html&gt; <br></pre>
      <small>
      <br>
      <span style="font-family: Courier New,Courier,monospace;">因
為問卷的答案可能是用中文填寫，為了順利取得中文，必須設定request的字元編碼處理方式，也就是呼叫setCharacterEncoding()
方法設定編碼。在這邊使用${pageContext.request}取得request物件，並透過&lt;c:set&gt;來進行設定。程式中需
要判斷顯示哪些問題時，則使用之前學習過的&lt;c:choose&gt;與&lt;c:when&gt;標籤。問卷過程中需儲存至session的答
案，則使用&lt;c:set&gt;來進行設定。</span><br>
      <br>
再來介紹<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">&lt;c:out&gt;</span>物件，它可以讓你輸出指定的文字。例如：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;c:out value="${param.message}"/&gt;</span></small><br>
      </div>
      <small><br>
      <span style="font-family: Courier New,Courier,monospace;">你也許會想這有什麼意思？為什麼不直接寫${param.message}就好，還要加上&lt;c:out&gt;標籤，這不是多此一舉嗎？如果${param.message}</span>是來自使用者於留言版所發送的訊息，而使用者故意打了HTML在訊息，則<span style="font-family: Courier New,Courier,monospace;">&lt;c:out&gt;會自動將角括號、單引號、雙引號等字元用替代字元取代。這個功能是由&lt;c:out&gt;的escapeXml屬性來控制，預設是true，如果設定為false，就不會作替代字元的取代。<br>
      <br>
      </span>EL運算結果為<span style="font-family: Courier New,Courier,monospace;">null</span>時，並不會顯示任何值，這原本是使用EL的好處，但如果你希望在EL運算結果為null時，可以顯示一個預設值，就目前你所學習到的JSTL標籤，你可能會這麼作：<br>
      </small>
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&lt;c:choose&gt;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; &lt;c:when test="${param.a != null}"&gt;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ${param.a}</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; &lt;/c:when&gt;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; &lt;c:otherwise&gt;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&nbsp;&nbsp;&nbsp; &lt;/c:otherwise&gt;</span></small><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">
      <small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">&lt;/c:choose&gt;</span></small><br>
      </div>
      <small><br>
      <span style="font-family: Courier New,Courier,monospace;">如果使用&lt;c:out&gt;的話，則可以更簡潔地達到這個目的，可以使用default</span>屬性設置EL運算結果為<span style="font-family: Courier New,Courier,monospace;">null</span>時的預設顯示值：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">&lt;c:out value="${param.a}" defalut="0"/&gt;</span></small><br>
      </div>
      <small><br>
      <br>

      </small></td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/ServletJSP/SetOutTag.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:17:54 GMT -->
</html>