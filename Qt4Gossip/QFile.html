<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from openhome.cc/Gossip/Qt4Gossip/QFile.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:10:42 GMT -->
<head>











  
  
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">











  
  
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">











  
  
  
  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type">










  
  
  
  
  
  
  
  
  
  
  <title>QFile</title>
</head>


<body>











<h3><a href="../index.html">From
Gossip@Openhome</a></h3>











<h1><a href="index-2.html">Qt4 Gossip: QFile</a></h1>











<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">











  <tbody>











    <tr>











      <td style="width: 676px; vertical-align: top;"> <small>QIODevice
是Qt中關於輸入輸出的基礎類別，其中關於檔案寫入與讀取的子類別是QFile，您可以使用exists()測試檔案是否存在，使用size()來取得檔
案大小，使用remove()來移除檔案，使用open()開啟檔案，使用readLine()讀取檔案，使用flush()確定寫出所有的資料，使用
close()關閉檔案等，如果在QFile離開呼叫的範圍之後，QFile也會自動關閉檔案。<br>

      <br>

QFile在開啟檔案的時候，可以設定開啟模式（OpenMode），例如QIODevice::ReadOnly、QIODevice::
WriteOnly、QIODevice::Append或QIODevice::ReadWrite等，您可以使用QFile來進行檔案讀取，但
QFile提供的是較低階的介面，通常會搭配QTextStream或QDataStream，在使用上較為方便，前者適用於純文字資料的讀取，後者為二
進位資料的存取。<br>

      <br>

以下的程式，直接使用QFile來進行檔案複製，程式使用QFile以唯讀方式讀取指定的來源檔案，以readAll()方式讀入資料為QByteArray，以唯寫方式寫入指定的目的檔案，將讀入的QByteArray使用write()寫入檔案，以完成複製的動作：<br>

      </small>
      
      <pre>#include &lt;QFile&gt;<br>#include &lt;QString&gt;<br>#include &lt;iostream&gt;<br>using namespace std;<br><br>int main(int argc, char *argv[]) {<br>    QString src(argv[1]);<br>    <br>    QFile srcFile(src);<br>    if (!srcFile.open(QIODevice::ReadOnly)) {<br>        cerr &lt;&lt; "Cannot open file for reading:"<br>             &lt;&lt; qPrintable(srcFile.errorString()) &lt;&lt; endl;<br>             <br>        return false;<br>    }<br>    <br>    QString dest(argv[2]);<br>    <br>    QFile destFile(dest);<br>    if (!destFile.open(QIODevice::WriteOnly)) {<br>        cerr &lt;&lt; "Cannot open file for writing: "<br>             &lt;&lt; qPrintable(destFile.errorString()) &lt;&lt; endl;<br>                                              <br>        return false;<br>    }<br>    <br>    QByteArray in = srcFile.readAll();<br>    <br>    destFile.write(in);<br>    <br>    return srcFile.error() == QFile::NoError<br>           &amp;&amp; destFile.error() == QFile::NoError;<br>}<br></pre>

      <small><br>

QFile的error()傳回代碼，表示檔案的讀取或寫入過程中是否有誤。程式執行時指定命令列引數如下以進行檔案複製：</small><br>




      
      
      
      <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">




        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">qcopy caterpillar.jpg caterpillar_backup.jpg</span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td>




          </tr>




        
        
        
        </tbody>
      
      
      
      </table>




      <small><br>

      </small>








      <span class="postbody"><br>










      </span> </td>











      <td style="width: 250px; text-align: center; vertical-align: top;"><!-- adsense for content-->
      
      
      
      
      
      
      
      
      
      
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      
      
      
      
      
      
      
      
      
      
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>











<!-- adsense for content end--><br>











<!-- adsense for content-->
      
      
      
      
      
      
      
      
      
      
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      
      
      
      
      
      
      
      
      
      
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><!-- adsense for content end--></td>











    </tr>











  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>











<br>










<span class="postbody"><br>











<br>











</span>
<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script>
</body>

<!-- Mirrored from openhome.cc/Gossip/Qt4Gossip/QFile.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:10:42 GMT -->
</html>
