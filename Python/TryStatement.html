<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/Python/TryStatement.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:15:42 GMT -->
<head>












  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>try、raise 陳述句</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">Python Gossip: try、raise 陳述句</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br> <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br> <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br></td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>以下這個程式，預期使用者要輸入整數：<br>
      </small>
      <pre>input = int(input('輸入整數：'))<br>print('{0} 為 {1}'.format(input, '奇數' if input % 2 else '偶數'))<br></pre>
      <br>
      <small>如果使用者輸入的不是整數，就會出現錯誤：</small><small><br></small>
      <table style="text-align: left; width: 100%; font-family: Courier New,Courier,monospace;" border="0" cellpadding="2" cellspacing="2">





        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">輸入整數：one<br>
Traceback (most recent call last):<br>
&nbsp; File "demo.py", line 1, in &lt;module&gt;<br>
&nbsp;&nbsp;&nbsp; input = int(input('輸入整數：'))<br>
ValueError: invalid literal for int() with base 10: 'one'</span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      </table>
      <br>
      <small>在Python中程式若發生錯誤，會丟出例外事件，以上例而言就是引發（Raise）<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">ValueError</span>物件，如果程式沒有處理例外而丟出至執行環境，則會顯示例外追蹤（Traceback）並中斷程式。如果你想要處理例外，則可以使用<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">try...except</span>語句。例如：<br>
      </small>
      <pre>try:<br>    input = int(input('輸入整數：'))<br>    print('{0} 為 {1}'.format(input, '奇數' if input % 2 else '偶數'))<br>except ValueError:<br>    print('請輸入阿拉伯數字')<br></pre>
      <small><br>
如果使用者輸入錯誤，引發的<span style="font-family: Courier New,Courier,monospace;">ValueError</span>物件會被<span style="font-family: Courier New,Courier,monospace;">except</span>比對型態是否相同，如果相同則執行對應的區塊。以上例而言，如果使用者輸入錯誤，就會顯示較友善的提示訊息（而不是丟個使用者看不懂的追蹤訊息）：</small><small><br></small>
      <table style="text-align: left; width: 100%; font-family: Courier New,Courier,monospace;" border="0" cellpadding="2" cellspacing="2">






        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);">輸入整數：one<br>
請輸入阿拉伯數字</span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      </table>

      <br>
      <small><span style="font-family: Courier New,Courier,monospace;">try..except的except可以指定多個物件，也可以有多個except，如果沒有指定except後的物件型態，則表示捕捉所有引發的物件。</span>舉例來說，上例中若使用者於輸入時輸入Ctrl+Z，在Windows環境下會引發<span style="font-family: Courier New,Courier,monospace;">EOFError</span>，若輸入Ctrl+C，則會引發<span style="font-family: Courier New,Courier,monospace;">KeyboardInterrupt。</span>下例中處理這些可能的狀況：<br>
      </small>
      <pre>import traceback<br>try:<br>    input = int(input('輸入整數：'))<br>    print('{0} 為 {1}'.format(input, '奇數' if input % 2 else '偶數'))<br>except ValueError:<br>    print('請輸入阿拉伯數字')<br>except (EOFError, KeyboardInterrupt):<br>    print('使用者中斷程式')<br>except:<br>    print('不明的程式中斷')<br>    traceback.print_exc()<br></pre>
      <small><br>
由於<span style="font-family: Courier New,Courier,monospace;">except</span>會捕捉所有引發的物件，所以必須置於最後。<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">traceback.print_exc()</span>則可以顯示例外的追蹤訊息<span style="font-family: Courier New,Courier,monospace;">。try還可以搭配<span style="font-weight: bold;">finally</span>，一但設置，無論有無引發物件，finally區塊一定會執行，這通常用來作為關閉若干資源的區塊，例如關閉檔案：</span><br>
      </small>
      <pre>file = open('demo.py', 'r', encoding='UTF-8')<br>try:<br>    for line in file:<br>        print(line, end='')<br>except:<br>    print('讀取檔案發生錯誤')<br>finally:<br>    file.close()<br></pre>
      <small><br>
      <span style="font-family: Courier New,Courier,monospace;">try也可以搭配<span style="font-weight: bold;">else</span>區塊，如果try區塊中沒有任何的錯誤發生，則會執行else區塊：</span><br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace; font-weight: bold;">try:</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp; statement</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">except some:</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp; statement</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">except:</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp; </small><small style="font-family: Courier New,Courier,monospace; font-weight: bold;">statement</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">else:</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp; statement</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">finally:</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp; statement</small><br>
      </div>
      <br>
      <small>你可以使用<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">raise</span>自行引發例外。例如：</small><small><br></small>
      <table style="text-align: left; width: 100%; font-family: Courier New,Courier,monospace;" border="0" cellpadding="2" cellspacing="2">







        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;&gt; try:</span><br style="font-weight: bold;">
            <span style="font-weight: bold;">...&nbsp;&nbsp;&nbsp;&nbsp; raise EOFError</span><br style="font-weight: bold;">
            <span style="font-weight: bold;">... except EOFError:</span><br style="font-weight: bold;">
            <span style="font-weight: bold;">...&nbsp;&nbsp;&nbsp;&nbsp; print('EOFError')</span><br style="font-weight: bold;">
            <span style="font-weight: bold;">...</span><br>
EOFError<br>
            <span style="font-weight: bold;">&gt;&gt;&gt;</span></span></small><span style="color: rgb(255, 255, 255);"><br>




            </span></td></tr></tbody>
      </table>


      <br>
      <small></small><br>
      <small><span style="font-family: Courier New,Courier,monospace;"></span><br>
      <br>
      <br>
      <br>
      </small></td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/Python/TryStatement.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:15:42 GMT -->
</html>