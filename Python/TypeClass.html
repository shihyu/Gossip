<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- Mirrored from openhome.cc/Gossip/Python/TypeClass.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:15:42 GMT -->
<head>













  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/stdlayout.css" type="text/css">







  
  
  
  
  
  
  
  <link rel="stylesheet" href="css/print.css" type="text/css">







  
  
  
  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type"><title>type 類別</title></head><body>







<h3><a href="../index.html">From
Gossip@Openhome</a></h3>







<h1><a href="index-2.html">Python Gossip: type 類別<br>
</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="vertical-align: top; width: 250px; text-align: center;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br> <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="../../../pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br><br></td>

      <td style="vertical-align: top; width: 690px; text-align: left;"><small>類別用來產生實例，每個實例都會有個<span style="font-family: Courier New,Courier,monospace; font-weight: bold;">__class__</span>特性，參考至產生它的類別。例如：</small><small><br></small>
      <table style="text-align: left; width: 100%; font-family: Courier New,Courier,monospace;" border="0" cellpadding="2" cellspacing="2">





        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;&gt; class Some:</span><br style="font-weight: bold;">
            <span style="font-weight: bold;">...&nbsp;&nbsp;&nbsp;&nbsp; pass</span><br style="font-weight: bold;">
            <span style="font-weight: bold;">...</span><br style="font-weight: bold;">
            <span style="font-weight: bold;">&gt;&gt;&gt; s = Some()</span><br style="font-weight: bold;">
            <span style="font-weight: bold;">&gt;&gt;&gt; s.__class__</span><br>
&lt;class '__main__.Some'&gt;<br>
            <span style="font-weight: bold;">&gt;&gt;&gt;</span></span></small></td></tr></tbody>
      </table>
      <br>
      <small><span style="font-family: Courier New,Courier,monospace;">一個事實是，類別本身也是物件，如果你透過類別的<span style="font-weight: bold;">__class__</span>來取得特性，它會是<span style="font-weight: bold;">type</span>類別的實例：</span></small><small><br></small>
      <table style="text-align: left; width: 100%; font-family: Courier New,Courier,monospace;" border="0" cellpadding="2" cellspacing="2">






        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;&gt; Some.__class__<br>
</span>&lt;class 'type'&gt;<span style="font-weight: bold;"><br>
&gt;&gt;&gt; type.__class__<br>
            </span>&lt;class 'type'&gt;<span style="font-weight: bold;"><br>
&gt;&gt;&gt;</span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      </table>

      <br>
      <small><span style="font-family: Courier New,Courier,monospace;">所有的類別，都是type類別的實例，type本身也是個類別，是用type定義產生出來的實例。<br>
      <br>
有個有趣的事是，產生類別實例的方式，可以透過類別的<span style="font-weight: bold;">__call__()</span>來達到相同的目的。例如：</span></small><small><br></small>
      <table style="text-align: left; width: 100%; font-family: Courier New,Courier,monospace;" border="0" cellpadding="2" cellspacing="2">







        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;&gt; class Some:<br>
...&nbsp;&nbsp;&nbsp;&nbsp; def __init__(self, arg):<br>
...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print('__init__')<br>
...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.arg = arg<br>
...<br>
&gt;&gt;&gt; s = Some()<br>
&gt;&gt;&gt; s = Some(10)<br>
</span>__init__<span style="font-weight: bold;"><br>
&gt;&gt;&gt; s.arg<br>
            </span>10<span style="font-weight: bold;"><br>
&gt;&gt;&gt; s2 = Some.__call__(20)<br>
            </span>__init__<span style="font-weight: bold;"><br>
&gt;&gt;&gt; s2.arg<br>
            </span>20<span style="font-weight: bold;"><br>
&gt;&gt;&gt;</span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      </table>


      <br>
      <small style="font-family: Courier New,Courier,monospace;">要了解為什麼，你必須先了解類別為type的實例這個事實，既然類別是type的實例，你可以嘗試使用type類別直接產生類別。例如：</small><small><br></small>
      <table style="text-align: left; width: 100%; font-family: Courier New,Courier,monospace;" border="0" cellpadding="2" cellspacing="2">








        <tbody>




          <tr>




            <td style="background-color: rgb(0, 0, 0);"><small><span style="color: rgb(255, 255, 255);"><span style="font-weight: bold;">&gt;&gt;&gt; def __init__(self, arg):<br>
...&nbsp;&nbsp;&nbsp;&nbsp; print('__init__')<br>
...&nbsp;&nbsp;&nbsp;&nbsp; self.arg = arg<br>
...<br>
&gt;&gt;&gt; Some = type('Some', (object,), {'__init__' : __init__})<br>
&gt;&gt;&gt; Some.__class__<br>
</span>&lt;class 'type'&gt;<span style="font-weight: bold;"><br>
&gt;&gt;&gt; s = Some(10)<br>
            </span>__init__<span style="font-weight: bold;"><br>
&gt;&gt;&gt; s.__class__<br>
            </span>&lt;class '__main__.Some'&gt;<span style="font-weight: bold;"><br>
&gt;&gt;&gt; s.arg<br>
            </span>10<span style="font-weight: bold;"><br>
&gt;&gt;&gt; help(type)<br>
            </span>Help on class type in module builtins:<br>
            <br>
class type(object)<br>
&nbsp;|&nbsp; type(object) -&gt; the object's type<br>
&nbsp;|&nbsp; type(name, bases, dict) -&gt; a new type<br>
&nbsp;|<br>
&nbsp;略<br>
<span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span></span></small></td></tr></tbody>
      </table>



      <br>
      <small style="font-family: Courier New,Courier,monospace;">type的三個引數分別是類別的名稱（字串）、類別的父類別（</small><small>Tuple</small><small style="font-family: Courier New,Courier,monospace;">）
與類別的特性（字典）。type會建立一個物件，該物件擁有__call__()方法，在上例中由Some名稱參考住該物件，如果以Some(10)呼叫
該物件，等同於呼叫Some.__call__(10)，而這會呼叫你指定的__init__方法（如果有__new__方法的話，會在__init__
前呼叫）。</small><br>
      <br>
      <small>事實上，當你這麼定義類別時：<br>
      </small>
      <div style="margin-left: 40px;"><small style="font-family: Courier New,Courier,monospace; font-weight: bold;">class Some:</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp; s = 10</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp; def __init__(self, arg):</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.arg = arg</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp; def doSome(self):</small><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
      <small style="font-family: Courier New,Courier,monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.arg += 1</small><br>
      </div>
      <small><br>
Python所作的是剖析完類別的陳述後，建立<span style="font-family: Courier New,Courier,monospace;">s參考至10、__init__與doSome參考至function實例，然後呼叫type來建立type實例並指定給Some名稱：<br>
      </span></small>
      <div style="margin-left: 40px;"><small><span style="font-family: Courier New,Courier,monospace;"><span style="font-weight: bold;">Some = type('Some', (object,), {'__init__' : __init__, 'doSome' : doSome})</span></span></small><br>
      <small><span style="font-family: Courier New,Courier,monospace;"></span></small></div>
      <br>
      <small>在Python中，物件是類別的實例，而<span style="font-family: Courier New,Courier,monospace;">類別是type的實例，如果你有方法可以介入type建立實例與初始化的過程，那麼你就有辦法改變類別的行為，這就是</span>meta class<span style="font-family: Courier New,Courier,monospace;">的基本概念。<br>
      <br>
注意，這與 </span></small><small><big><a href="ClassDecorator.html"><small>類別修飾器</small></a></big> 的概念不同，</small><small><span style="font-family: Courier New,Courier,monospace;">當你使用類別修飾器時，類別本身已經產生，也就是已經產了type實例了，然後你才去修飾類別的行為，</span>meta class<span style="font-family: Courier New,Courier,monospace;">則是直接介入type實例產生與初始化的過程，使用的時機點並不相同。<br>
      </span><br>
      </small><br>
</td>

    </tr>

  </tbody>
</table>

<br>
<br>

<br>

<br>







<script src="../../../www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script></body>
<!-- Mirrored from openhome.cc/Gossip/Python/TypeClass.html by HTTrack Website Copier/3.x [XR&CO'2008], Sun, 28 Jul 2013 09:15:42 GMT -->
</html>